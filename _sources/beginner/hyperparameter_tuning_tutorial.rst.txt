.. note::
    :class: sphx-glr-download-link-note

    Click :ref:`here <sphx_glr_download_beginner_hyperparameter_tuning_tutorial.py>` to download the full example code
.. rst-class:: sphx-glr-example-title

.. _sphx_glr_beginner_hyperparameter_tuning_tutorial.py:


Hyperparameter tuning with Ray Tune
===================================

Hyperparameter tuning can make the difference between an average model and a highly
accurate one. Often simple things like choosing a different learning rate or changing
a network layer size can have a dramatic impact on your model performance.

Fortunately, there are tools that help with finding the best combination of parameters.
`Ray Tune <https://docs.ray.io/en/latest/tune.html>`_ is an industry standard tool for
distributed hyperparameter tuning. Ray Tune includes the latest hyperparameter search
algorithms, integrates with TensorBoard and other analysis libraries, and natively
supports distributed training through `Ray's distributed machine learning engine
<https://ray.io/>`_.

In this tutorial, we will show you how to integrate Ray Tune into your PyTorch
training workflow. We will extend `this tutorial from the PyTorch documentation
<https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html>`_ for training
a CIFAR10 image classifier.

As you will see, we only need to add some slight modifications. In particular, we
need to

1. wrap data loading and training in functions,
2. make some network parameters configurable,
3. add checkpointing (optional),
4. and define the search space for the model tuning

|

To run this tutorial, please make sure the following packages are
installed:

-  ``ray[tune]``: Distributed hyperparameter tuning library
-  ``torchvision``: For the data transformers

Setup / Imports
---------------
Let's start with the imports:


.. code-block:: default

    from functools import partial
    import numpy as np
    import os
    import torch
    import torch.nn as nn
    import torch.nn.functional as F
    import torch.optim as optim
    from torch.utils.data import random_split
    import torchvision
    import torchvision.transforms as transforms
    from ray import tune
    from ray.tune import CLIReporter
    from ray.tune.schedulers import ASHAScheduler







Most of the imports are needed for building the PyTorch model. Only the last three
imports are for Ray Tune.

Data loaders
------------
We wrap the data loaders in their own function and pass a global data directory.
This way we can share a data directory between different trials.


.. code-block:: default



    def load_data(data_dir="./data"):
        transform = transforms.Compose([
            transforms.ToTensor(),
            transforms.Normalize((0.5, 0.5, 0.5), (0.5, 0.5, 0.5))
        ])

        trainset = torchvision.datasets.CIFAR10(
            root=data_dir, train=True, download=True, transform=transform)

        testset = torchvision.datasets.CIFAR10(
            root=data_dir, train=False, download=True, transform=transform)

        return trainset, testset







Configurable neural network
---------------------------
We can only tune those parameters that are configurable. In this example, we can specify
the layer sizes of the fully connected layers:


.. code-block:: default



    class Net(nn.Module):
        def __init__(self, l1=120, l2=84):
            super(Net, self).__init__()
            self.conv1 = nn.Conv2d(3, 6, 5)
            self.pool = nn.MaxPool2d(2, 2)
            self.conv2 = nn.Conv2d(6, 16, 5)
            self.fc1 = nn.Linear(16 * 5 * 5, l1)
            self.fc2 = nn.Linear(l1, l2)
            self.fc3 = nn.Linear(l2, 10)

        def forward(self, x):
            x = self.pool(F.relu(self.conv1(x)))
            x = self.pool(F.relu(self.conv2(x)))
            x = x.view(-1, 16 * 5 * 5)
            x = F.relu(self.fc1(x))
            x = F.relu(self.fc2(x))
            x = self.fc3(x)
            return x







The train function
------------------
Now it gets interesting, because we introduce some changes to the example `from the PyTorch
documentation <https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html>`_.

We wrap the training script in a function ``train_cifar(config, checkpoint_dir=None, data_dir=None)``.
As you can guess, the ``config`` parameter will receive the hyperparameters we would like to
train with. The ``checkpoint_dir`` parameter is used to restore checkpoints. The ``data_dir`` specifies
the directory where we load and store the data, so multiple runs can share the same data source.

.. code-block:: python

    net = Net(config["l1"], config["l2"])

    if checkpoint_dir:
        model_state, optimizer_state = torch.load(
            os.path.join(checkpoint_dir, "checkpoint"))
        net.load_state_dict(model_state)
        optimizer.load_state_dict(optimizer_state)

The learning rate of the optimizer is made configurable, too:

.. code-block:: python

    optimizer = optim.SGD(net.parameters(), lr=config["lr"], momentum=0.9)

We also split the training data into a training and validation subset. We thus train on
80% of the data and calculate the validation loss on the remaining 20%. The batch sizes
with which we iterate through the training and test sets are configurable as well.

Adding (multi) GPU support with DataParallel
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Image classification benefits largely from GPUs. Luckily, we can continue to use
PyTorch's abstractions in Ray Tune. Thus, we can wrap our model in ``nn.DataParallel``
to support data parallel training on multiple GPUs:

.. code-block:: python

    device = "cpu"
    if torch.cuda.is_available():
        device = "cuda:0"
        if torch.cuda.device_count() > 1:
            net = nn.DataParallel(net)
    net.to(device)

By using a ``device`` variable we make sure that training also works when we have
no GPUs available. PyTorch requires us to send our data to the GPU memory explicitly,
like this:

.. code-block:: python

    for i, data in enumerate(trainloader, 0):
        inputs, labels = data
        inputs, labels = inputs.to(device), labels.to(device)

The code now supports training on CPUs, on a single GPU, and on multiple GPUs. Notably, Ray
also supports `fractional GPUs <https://docs.ray.io/en/master/using-ray-with-gpus.html#fractional-gpus>`_
so we can share GPUs among trials, as long as the model still fits on the GPU memory. We'll come back
to that later.

Communicating with Ray Tune
~~~~~~~~~~~~~~~~~~~~~~~~~~~

The most interesting part is the communication with Ray Tune:

.. code-block:: python

    with tune.checkpoint_dir(epoch) as checkpoint_dir:
        path = os.path.join(checkpoint_dir, "checkpoint")
        torch.save((net.state_dict(), optimizer.state_dict()), path)

    tune.report(loss=(val_loss / val_steps), accuracy=correct / total)

Here we first save a checkpoint and then report some metrics back to Ray Tune. Specifically,
we send the validation loss and accuracy back to Ray Tune. Ray Tune can then use these metrics
to decide which hyperparameter configuration lead to the best results. These metrics
can also be used to stop bad performing trials early in order to avoid wasting
resources on those trials.

The checkpoint saving is optional, however, it is necessary if we wanted to use advanced
schedulers like
`Population Based Training <https://docs.ray.io/en/master/tune/tutorials/tune-advanced-tutorial.html>`_.
Also, by saving the checkpoint we can later load the trained models and validate them
on a test set.

Full training function
~~~~~~~~~~~~~~~~~~~~~~

The full code example looks like this:


.. code-block:: default



    def train_cifar(config, checkpoint_dir=None, data_dir=None):
        net = Net(config["l1"], config["l2"])

        device = "cpu"
        if torch.cuda.is_available():
            device = "cuda:0"
            if torch.cuda.device_count() > 1:
                net = nn.DataParallel(net)
        net.to(device)

        criterion = nn.CrossEntropyLoss()
        optimizer = optim.SGD(net.parameters(), lr=config["lr"], momentum=0.9)

        if checkpoint_dir:
            model_state, optimizer_state = torch.load(
                os.path.join(checkpoint_dir, "checkpoint"))
            net.load_state_dict(model_state)
            optimizer.load_state_dict(optimizer_state)

        trainset, testset = load_data(data_dir)

        test_abs = int(len(trainset) * 0.8)
        train_subset, val_subset = random_split(
            trainset, [test_abs, len(trainset) - test_abs])

        trainloader = torch.utils.data.DataLoader(
            train_subset,
            batch_size=int(config["batch_size"]),
            shuffle=True,
            num_workers=8)
        valloader = torch.utils.data.DataLoader(
            val_subset,
            batch_size=int(config["batch_size"]),
            shuffle=True,
            num_workers=8)

        for epoch in range(10):  # loop over the dataset multiple times
            running_loss = 0.0
            epoch_steps = 0
            for i, data in enumerate(trainloader, 0):
                # get the inputs; data is a list of [inputs, labels]
                inputs, labels = data
                inputs, labels = inputs.to(device), labels.to(device)

                # zero the parameter gradients
                optimizer.zero_grad()

                # forward + backward + optimize
                outputs = net(inputs)
                loss = criterion(outputs, labels)
                loss.backward()
                optimizer.step()

                # print statistics
                running_loss += loss.item()
                epoch_steps += 1
                if i % 2000 == 1999:  # print every 2000 mini-batches
                    print("[%d, %5d] loss: %.3f" % (epoch + 1, i + 1,
                                                    running_loss / epoch_steps))
                    running_loss = 0.0

            # Validation loss
            val_loss = 0.0
            val_steps = 0
            total = 0
            correct = 0
            for i, data in enumerate(valloader, 0):
                with torch.no_grad():
                    inputs, labels = data
                    inputs, labels = inputs.to(device), labels.to(device)

                    outputs = net(inputs)
                    _, predicted = torch.max(outputs.data, 1)
                    total += labels.size(0)
                    correct += (predicted == labels).sum().item()

                    loss = criterion(outputs, labels)
                    val_loss += loss.cpu().numpy()
                    val_steps += 1

            with tune.checkpoint_dir(epoch) as checkpoint_dir:
                path = os.path.join(checkpoint_dir, "checkpoint")
                torch.save((net.state_dict(), optimizer.state_dict()), path)

            tune.report(loss=(val_loss / val_steps), accuracy=correct / total)
        print("Finished Training")







As you can see, most of the code is adapted directly from the original example.

Test set accuracy
-----------------
Commonly the performance of a machine learning model is tested on a hold-out test
set with data that has not been used for training the model. We also wrap this in a
function:


.. code-block:: default



    def test_accuracy(net, device="cpu"):
        trainset, testset = load_data()

        testloader = torch.utils.data.DataLoader(
            testset, batch_size=4, shuffle=False, num_workers=2)

        correct = 0
        total = 0
        with torch.no_grad():
            for data in testloader:
                images, labels = data
                images, labels = images.to(device), labels.to(device)
                outputs = net(images)
                _, predicted = torch.max(outputs.data, 1)
                total += labels.size(0)
                correct += (predicted == labels).sum().item()

        return correct / total







The function also expects a ``device`` parameter, so we can do the
test set validation on a GPU.

Configuring the search space
----------------------------
Lastly, we need to define Ray Tune's search space. Here is an example:

.. code-block:: python

    config = {
        "l1": tune.sample_from(lambda _: 2**np.random.randint(2, 9)),
        "l2": tune.sample_from(lambda _: 2**np.random.randint(2, 9)),
        "lr": tune.loguniform(1e-4, 1e-1),
        "batch_size": tune.choice([2, 4, 8, 16])
    }

The ``tune.sample_from()`` function makes it possible to define your own sample
methods to obtain hyperparameters. In this example, the ``l1`` and ``l2`` parameters
should be powers of 2 between 4 and 256, so either 4, 8, 16, 32, 64, 128, or 256.
The ``lr`` (learning rate) should be uniformly sampled between 0.0001 and 0.1. Lastly,
the batch size is a choice between 2, 4, 8, and 16.

At each trial, Ray Tune will now randomly sample a combination of parameters from these
search spaces. It will then train a number of models in parallel and find the best
performing one among these. We also use the ``ASHAScheduler`` which will terminate bad
performing trials early.

We wrap the ``train_cifar`` function with ``functools.partial`` to set the constant
``data_dir`` parameter. We can also tell Ray Tune what resources should be
available for each trial:

.. code-block:: python

    gpus_per_trial = 2
    # ...
    result = tune.run(
        partial(train_cifar, data_dir=data_dir),
        resources_per_trial={"cpu": 8, "gpu": gpus_per_trial},
        config=config,
        num_samples=num_samples,
        scheduler=scheduler,
        progress_reporter=reporter,
        checkpoint_at_end=True)

You can specify the number of CPUs, which are then available e.g.
to increase the ``num_workers`` of the PyTorch ``DataLoader`` instances. The selected
number of GPUs are made visible to PyTorch in each trial. Trials do not have access to
GPUs that haven't been requested for them - so you don't have to care about two trials
using the same set of resources.

Here we can also specify fractional GPUs, so something like ``gpus_per_trial=0.5`` is
completely valid. The trials will then share GPUs among each other.
You just have to make sure that the models still fit in the GPU memory.

After training the models, we will find the best performing one and load the trained
network from the checkpoint file. We then obtain the test set accuracy and report
everything by printing.

The full main function looks like this:


.. code-block:: default



    def main(num_samples=10, max_num_epochs=10, gpus_per_trial=2):
        data_dir = os.path.abspath("./data")
        load_data(data_dir)
        config = {
            "l1": tune.sample_from(lambda _: 2 ** np.random.randint(2, 9)),
            "l2": tune.sample_from(lambda _: 2 ** np.random.randint(2, 9)),
            "lr": tune.loguniform(1e-4, 1e-1),
            "batch_size": tune.choice([2, 4, 8, 16])
        }
        scheduler = ASHAScheduler(
            metric="loss",
            mode="min",
            max_t=max_num_epochs,
            grace_period=1,
            reduction_factor=2)
        reporter = CLIReporter(
            # parameter_columns=["l1", "l2", "lr", "batch_size"],
            metric_columns=["loss", "accuracy", "training_iteration"])
        result = tune.run(
            partial(train_cifar, data_dir=data_dir),
            resources_per_trial={"cpu": 2, "gpu": gpus_per_trial},
            config=config,
            num_samples=num_samples,
            scheduler=scheduler,
            progress_reporter=reporter)

        best_trial = result.get_best_trial("loss", "min", "last")
        print("Best trial config: {}".format(best_trial.config))
        print("Best trial final validation loss: {}".format(
            best_trial.last_result["loss"]))
        print("Best trial final validation accuracy: {}".format(
            best_trial.last_result["accuracy"]))

        best_trained_model = Net(best_trial.config["l1"], best_trial.config["l2"])
        device = "cpu"
        if torch.cuda.is_available():
            device = "cuda:0"
            if gpus_per_trial > 1:
                best_trained_model = nn.DataParallel(best_trained_model)
        best_trained_model.to(device)

        best_checkpoint_dir = best_trial.checkpoint.value
        model_state, optimizer_state = torch.load(os.path.join(
            best_checkpoint_dir, "checkpoint"))
        best_trained_model.load_state_dict(model_state)

        test_acc = test_accuracy(best_trained_model, device)
        print("Best trial test set accuracy: {}".format(test_acc))


    if __name__ == "__main__":
        # You can change the number of GPUs per trial here:
        main(num_samples=10, max_num_epochs=10, gpus_per_trial=0)






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to /var/lib/jenkins/workspace/beginner_source/data/cifar-10-python.tar.gz
    Extracting /var/lib/jenkins/workspace/beginner_source/data/cifar-10-python.tar.gz to /var/lib/jenkins/workspace/beginner_source/data
    Files already downloaded and verified
    == Status ==
    Memory usage on this node: 4.0/240.1 GiB
    Using AsyncHyperBand: num_stopped=0
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: None
    Resources requested: 2/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT
    Number of trials: 10 (9 PENDING, 1 RUNNING)
    +---------------------+----------+-------+--------------+------+------+-------------+
    | Trial name          | status   | loc   |   batch_size |   l1 |   l2 |          lr |
    |---------------------+----------+-------+--------------+------+------+-------------|
    | DEFAULT_79ae1_00000 | RUNNING  |       |           16 |  256 |    8 | 0.000100905 |
    | DEFAULT_79ae1_00001 | PENDING  |       |            4 |    4 |   64 | 0.00502624  |
    | DEFAULT_79ae1_00002 | PENDING  |       |            8 |    8 |    8 | 0.000388007 |
    | DEFAULT_79ae1_00003 | PENDING  |       |           16 |    4 |   32 | 0.0243759   |
    | DEFAULT_79ae1_00004 | PENDING  |       |            2 |   32 |  128 | 0.00376088  |
    | DEFAULT_79ae1_00005 | PENDING  |       |           16 |    8 |   32 | 0.0600091   |
    | DEFAULT_79ae1_00006 | PENDING  |       |            2 |  128 |   64 | 0.0318437   |
    | DEFAULT_79ae1_00007 | PENDING  |       |            8 |    8 |    8 | 0.00975354  |
    | DEFAULT_79ae1_00008 | PENDING  |       |            2 |   64 |  128 | 0.00594678  |
    | DEFAULT_79ae1_00009 | PENDING  |       |            8 |    8 |    4 | 0.000398399 |
    +---------------------+----------+-------+--------------+------+------+-------------+


    [2m[36m(pid=1092)[0m Files already downloaded and verified
    [2m[36m(pid=1136)[0m Files already downloaded and verified
    [2m[36m(pid=1088)[0m Files already downloaded and verified
    [2m[36m(pid=1101)[0m Files already downloaded and verified
    [2m[36m(pid=1168)[0m Files already downloaded and verified
    [2m[36m(pid=1081)[0m Files already downloaded and verified
    [2m[36m(pid=1098)[0m Files already downloaded and verified
    [2m[36m(pid=1082)[0m Files already downloaded and verified
    [2m[36m(pid=1090)[0m Files already downloaded and verified
    [2m[36m(pid=1093)[0m Files already downloaded and verified
    [2m[36m(pid=1092)[0m Files already downloaded and verified
    [2m[36m(pid=1136)[0m Files already downloaded and verified
    [2m[36m(pid=1088)[0m Files already downloaded and verified
    [2m[36m(pid=1101)[0m Files already downloaded and verified
    [2m[36m(pid=1168)[0m Files already downloaded and verified
    [2m[36m(pid=1098)[0m Files already downloaded and verified
    [2m[36m(pid=1081)[0m Files already downloaded and verified
    [2m[36m(pid=1082)[0m Files already downloaded and verified
    [2m[36m(pid=1090)[0m Files already downloaded and verified
    [2m[36m(pid=1093)[0m Files already downloaded and verified
    [2m[36m(pid=1081)[0m [1,  2000] loss: 2.198
    [2m[36m(pid=1093)[0m [1,  2000] loss: 2.108
    [2m[36m(pid=1136)[0m [1,  2000] loss: 2.093
    [2m[36m(pid=1090)[0m [1,  2000] loss: 2.341
    [2m[36m(pid=1082)[0m [1,  2000] loss: 2.051
    [2m[36m(pid=1101)[0m [1,  2000] loss: 2.295
    [2m[36m(pid=1098)[0m [1,  2000] loss: 2.313
    [2m[36m(pid=1088)[0m [1,  2000] loss: 1.993
    [2m[36m(pid=1168)[0m [1,  2000] loss: 2.236
    [2m[36m(pid=1092)[0m [1,  2000] loss: 2.326
    [2m[36m(pid=1081)[0m [1,  4000] loss: 1.029
    [2m[36m(pid=1093)[0m [1,  4000] loss: 0.970
    [2m[36m(pid=1136)[0m [1,  4000] loss: 0.964
    Result for DEFAULT_79ae1_00003:
      accuracy: 0.2766
      date: 2020-09-21_20-39-29
      done: false
      experiment_id: 9946778a87714a4894cfc1180226834e
      experiment_tag: 3_batch_size=16,l1=4,l2=32,lr=0.024376
      hostname: 18e16d8a13a6
      iterations_since_restore: 1
      loss: 1.8650087287902832
      node_ip: 172.17.0.2
      pid: 1088
      should_checkpoint: true
      time_since_restore: 30.090057611465454
      time_this_iter_s: 30.090057611465454
      time_total_s: 30.090057611465454
      timestamp: 1600720769
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 79ae1_00003
  
    == Status ==
    Memory usage on this node: 8.7/240.1 GiB
    Using AsyncHyperBand: num_stopped=0
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: -1.8650087287902832
    Resources requested: 20/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT
    Number of trials: 10 (10 RUNNING)
    +---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status   | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_79ae1_00000 | RUNNING  |                 |           16 |  256 |    8 | 0.000100905 |         |            |                      |
    | DEFAULT_79ae1_00001 | RUNNING  |                 |            4 |    4 |   64 | 0.00502624  |         |            |                      |
    | DEFAULT_79ae1_00002 | RUNNING  |                 |            8 |    8 |    8 | 0.000388007 |         |            |                      |
    | DEFAULT_79ae1_00003 | RUNNING  | 172.17.0.2:1088 |           16 |    4 |   32 | 0.0243759   | 1.86501 |     0.2766 |                    1 |
    | DEFAULT_79ae1_00004 | RUNNING  |                 |            2 |   32 |  128 | 0.00376088  |         |            |                      |
    | DEFAULT_79ae1_00005 | RUNNING  |                 |           16 |    8 |   32 | 0.0600091   |         |            |                      |
    | DEFAULT_79ae1_00006 | RUNNING  |                 |            2 |  128 |   64 | 0.0318437   |         |            |                      |
    | DEFAULT_79ae1_00007 | RUNNING  |                 |            8 |    8 |    8 | 0.00975354  |         |            |                      |
    | DEFAULT_79ae1_00008 | RUNNING  |                 |            2 |   64 |  128 | 0.00594678  |         |            |                      |
    | DEFAULT_79ae1_00009 | RUNNING  |                 |            8 |    8 |    4 | 0.000398399 |         |            |                      |
    +---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_79ae1_00005:
      accuracy: 0.0997
      date: 2020-09-21_20-39-30
      done: true
      experiment_id: 358210cbe29c447b8922d5ac70be5baf
      experiment_tag: 5_batch_size=16,l1=8,l2=32,lr=0.060009
      hostname: 18e16d8a13a6
      iterations_since_restore: 1
      loss: 2.304117810821533
      node_ip: 172.17.0.2
      pid: 1168
      should_checkpoint: true
      time_since_restore: 30.121013402938843
      time_this_iter_s: 30.121013402938843
      time_total_s: 30.121013402938843
      timestamp: 1600720770
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 79ae1_00005
  
    [2m[36m(pid=1090)[0m [1,  4000] loss: 1.171
    Result for DEFAULT_79ae1_00000:
      accuracy: 0.1017
      date: 2020-09-21_20-39-31
      done: true
      experiment_id: 1232104623c74c169299d915ce855211
      experiment_tag: 0_batch_size=16,l1=256,l2=8,lr=0.0001009
      hostname: 18e16d8a13a6
      iterations_since_restore: 1
      loss: 2.322201280593872
      node_ip: 172.17.0.2
      pid: 1092
      should_checkpoint: true
      time_since_restore: 31.363142013549805
      time_this_iter_s: 31.363142013549805
      time_total_s: 31.363142013549805
      timestamp: 1600720771
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 79ae1_00000
  
    [2m[36m(pid=1082)[0m [1,  4000] loss: 0.942
    [2m[36m(pid=1101)[0m [1,  4000] loss: 1.101
    [2m[36m(pid=1098)[0m [1,  4000] loss: 1.153
    [2m[36m(pid=1081)[0m [1,  6000] loss: 0.676
    [2m[36m(pid=1093)[0m [1,  6000] loss: 0.625
    [2m[36m(pid=1136)[0m [1,  6000] loss: 0.623
    [2m[36m(pid=1090)[0m [1,  6000] loss: 0.779
    Result for DEFAULT_79ae1_00007:
      accuracy: 0.3078
      date: 2020-09-21_20-39-42
      done: false
      experiment_id: b968c158f8f04acfa889e6269e06743b
      experiment_tag: 7_batch_size=8,l1=8,l2=8,lr=0.0097535
      hostname: 18e16d8a13a6
      iterations_since_restore: 1
      loss: 1.7980498471736908
      node_ip: 172.17.0.2
      pid: 1082
      should_checkpoint: true
      time_since_restore: 42.05501317977905
      time_this_iter_s: 42.05501317977905
      time_total_s: 42.05501317977905
      timestamp: 1600720782
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 79ae1_00007
  
    == Status ==
    Memory usage on this node: 7.7/240.1 GiB
    Using AsyncHyperBand: num_stopped=2
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: -2.0845632698059084
    Resources requested: 16/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT
    Number of trials: 10 (8 RUNNING, 2 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_79ae1_00000 | TERMINATED |                 |           16 |  256 |    8 | 0.000100905 | 2.3222  |     0.1017 |                    1 |
    | DEFAULT_79ae1_00001 | RUNNING    |                 |            4 |    4 |   64 | 0.00502624  |         |            |                      |
    | DEFAULT_79ae1_00002 | RUNNING    |                 |            8 |    8 |    8 | 0.000388007 |         |            |                      |
    | DEFAULT_79ae1_00003 | RUNNING    | 172.17.0.2:1088 |           16 |    4 |   32 | 0.0243759   | 1.86501 |     0.2766 |                    1 |
    | DEFAULT_79ae1_00004 | RUNNING    |                 |            2 |   32 |  128 | 0.00376088  |         |            |                      |
    | DEFAULT_79ae1_00005 | TERMINATED |                 |           16 |    8 |   32 | 0.0600091   | 2.30412 |     0.0997 |                    1 |
    | DEFAULT_79ae1_00006 | RUNNING    |                 |            2 |  128 |   64 | 0.0318437   |         |            |                      |
    | DEFAULT_79ae1_00007 | RUNNING    | 172.17.0.2:1082 |            8 |    8 |    8 | 0.00975354  | 1.79805 |     0.3078 |                    1 |
    | DEFAULT_79ae1_00008 | RUNNING    |                 |            2 |   64 |  128 | 0.00594678  |         |            |                      |
    | DEFAULT_79ae1_00009 | RUNNING    |                 |            8 |    8 |    4 | 0.000398399 |         |            |                      |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_79ae1_00002:
      accuracy: 0.1955
      date: 2020-09-21_20-39-42
      done: false
      experiment_id: cfab037e3fcd473a92d773d729f383ed
      experiment_tag: 2_batch_size=8,l1=8,l2=8,lr=0.00038801
      hostname: 18e16d8a13a6
      iterations_since_restore: 1
      loss: 2.076271940612793
      node_ip: 172.17.0.2
      pid: 1101
      should_checkpoint: true
      time_since_restore: 42.41563439369202
      time_this_iter_s: 42.41563439369202
      time_total_s: 42.41563439369202
      timestamp: 1600720782
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 79ae1_00002
  
    Result for DEFAULT_79ae1_00009:
      accuracy: 0.097
      date: 2020-09-21_20-39-42
      done: true
      experiment_id: 1089e175a9f04f77a14e5004f79b4f3d
      experiment_tag: 9_batch_size=8,l1=8,l2=4,lr=0.0003984
      hostname: 18e16d8a13a6
      iterations_since_restore: 1
      loss: 2.302834967803955
      node_ip: 172.17.0.2
      pid: 1098
      should_checkpoint: true
      time_since_restore: 42.55151081085205
      time_this_iter_s: 42.55151081085205
      time_total_s: 42.55151081085205
      timestamp: 1600720782
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 79ae1_00009
  
    [2m[36m(pid=1088)[0m [2,  2000] loss: 1.913
    [2m[36m(pid=1081)[0m [1,  8000] loss: 0.502
    [2m[36m(pid=1093)[0m [1,  8000] loss: 0.477
    [2m[36m(pid=1136)[0m [1,  8000] loss: 0.460
    Result for DEFAULT_79ae1_00003:
      accuracy: 0.223
      date: 2020-09-21_20-39-50
      done: false
      experiment_id: 9946778a87714a4894cfc1180226834e
      experiment_tag: 3_batch_size=16,l1=4,l2=32,lr=0.024376
      hostname: 18e16d8a13a6
      iterations_since_restore: 2
      loss: 1.9946562120437623
      node_ip: 172.17.0.2
      pid: 1088
      should_checkpoint: true
      time_since_restore: 50.51594424247742
      time_this_iter_s: 20.425886631011963
      time_total_s: 50.51594424247742
      timestamp: 1600720790
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: 79ae1_00003
  
    == Status ==
    Memory usage on this node: 7.2/240.1 GiB
    Using AsyncHyperBand: num_stopped=3
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -1.9946562120437623 | Iter 1.000: -2.189553454208374
    Resources requested: 14/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT
    Number of trials: 10 (7 RUNNING, 3 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_79ae1_00000 | TERMINATED |                 |           16 |  256 |    8 | 0.000100905 | 2.3222  |     0.1017 |                    1 |
    | DEFAULT_79ae1_00001 | RUNNING    |                 |            4 |    4 |   64 | 0.00502624  |         |            |                      |
    | DEFAULT_79ae1_00002 | RUNNING    | 172.17.0.2:1101 |            8 |    8 |    8 | 0.000388007 | 2.07627 |     0.1955 |                    1 |
    | DEFAULT_79ae1_00003 | RUNNING    | 172.17.0.2:1088 |           16 |    4 |   32 | 0.0243759   | 1.99466 |     0.223  |                    2 |
    | DEFAULT_79ae1_00004 | RUNNING    |                 |            2 |   32 |  128 | 0.00376088  |         |            |                      |
    | DEFAULT_79ae1_00005 | TERMINATED |                 |           16 |    8 |   32 | 0.0600091   | 2.30412 |     0.0997 |                    1 |
    | DEFAULT_79ae1_00006 | RUNNING    |                 |            2 |  128 |   64 | 0.0318437   |         |            |                      |
    | DEFAULT_79ae1_00007 | RUNNING    | 172.17.0.2:1082 |            8 |    8 |    8 | 0.00975354  | 1.79805 |     0.3078 |                    1 |
    | DEFAULT_79ae1_00008 | RUNNING    |                 |            2 |   64 |  128 | 0.00594678  |         |            |                      |
    | DEFAULT_79ae1_00009 | TERMINATED |                 |            8 |    8 |    4 | 0.000398399 | 2.30283 |     0.097  |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1090)[0m [1,  8000] loss: 0.585
    [2m[36m(pid=1082)[0m [2,  2000] loss: 1.863
    [2m[36m(pid=1101)[0m [2,  2000] loss: 2.013
    [2m[36m(pid=1081)[0m [1, 10000] loss: 0.405
    [2m[36m(pid=1093)[0m [1, 10000] loss: 0.375
    [2m[36m(pid=1136)[0m [1, 10000] loss: 0.363
    [2m[36m(pid=1090)[0m [1, 10000] loss: 0.467
    [2m[36m(pid=1081)[0m [1, 12000] loss: 0.333
    [2m[36m(pid=1093)[0m [1, 12000] loss: 0.311
    [2m[36m(pid=1082)[0m [2,  4000] loss: 0.904
    Result for DEFAULT_79ae1_00001:
      accuracy: 0.3275
      date: 2020-09-21_20-40-03
      done: false
      experiment_id: 1bbc7a7895e54fbcb940a03305b600d0
      experiment_tag: 1_batch_size=4,l1=4,l2=64,lr=0.0050262
      hostname: 18e16d8a13a6
      iterations_since_restore: 1
      loss: 1.7699519322037698
      node_ip: 172.17.0.2
      pid: 1136
      should_checkpoint: true
      time_since_restore: 63.868627309799194
      time_this_iter_s: 63.868627309799194
      time_total_s: 63.868627309799194
      timestamp: 1600720803
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 79ae1_00001
  
    == Status ==
    Memory usage on this node: 7.2/240.1 GiB
    Using AsyncHyperBand: num_stopped=3
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -1.9946562120437623 | Iter 1.000: -2.076271940612793
    Resources requested: 14/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT
    Number of trials: 10 (7 RUNNING, 3 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_79ae1_00000 | TERMINATED |                 |           16 |  256 |    8 | 0.000100905 | 2.3222  |     0.1017 |                    1 |
    | DEFAULT_79ae1_00001 | RUNNING    | 172.17.0.2:1136 |            4 |    4 |   64 | 0.00502624  | 1.76995 |     0.3275 |                    1 |
    | DEFAULT_79ae1_00002 | RUNNING    | 172.17.0.2:1101 |            8 |    8 |    8 | 0.000388007 | 2.07627 |     0.1955 |                    1 |
    | DEFAULT_79ae1_00003 | RUNNING    | 172.17.0.2:1088 |           16 |    4 |   32 | 0.0243759   | 1.99466 |     0.223  |                    2 |
    | DEFAULT_79ae1_00004 | RUNNING    |                 |            2 |   32 |  128 | 0.00376088  |         |            |                      |
    | DEFAULT_79ae1_00005 | TERMINATED |                 |           16 |    8 |   32 | 0.0600091   | 2.30412 |     0.0997 |                    1 |
    | DEFAULT_79ae1_00006 | RUNNING    |                 |            2 |  128 |   64 | 0.0318437   |         |            |                      |
    | DEFAULT_79ae1_00007 | RUNNING    | 172.17.0.2:1082 |            8 |    8 |    8 | 0.00975354  | 1.79805 |     0.3078 |                    1 |
    | DEFAULT_79ae1_00008 | RUNNING    |                 |            2 |   64 |  128 | 0.00594678  |         |            |                      |
    | DEFAULT_79ae1_00009 | TERMINATED |                 |            8 |    8 |    4 | 0.000398399 | 2.30283 |     0.097  |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1088)[0m [3,  2000] loss: 2.061
    [2m[36m(pid=1101)[0m [2,  4000] loss: 0.957
    Result for DEFAULT_79ae1_00003:
      accuracy: 0.1002
      date: 2020-09-21_20-40-10
      done: false
      experiment_id: 9946778a87714a4894cfc1180226834e
      experiment_tag: 3_batch_size=16,l1=4,l2=32,lr=0.024376
      hostname: 18e16d8a13a6
      iterations_since_restore: 3
      loss: 2.3069201332092284
      node_ip: 172.17.0.2
      pid: 1088
      should_checkpoint: true
      time_since_restore: 70.4439582824707
      time_this_iter_s: 19.928014039993286
      time_total_s: 70.4439582824707
      timestamp: 1600720810
      timesteps_since_restore: 0
      training_iteration: 3
      trial_id: 79ae1_00003
  
    == Status ==
    Memory usage on this node: 7.2/240.1 GiB
    Using AsyncHyperBand: num_stopped=3
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -1.9946562120437623 | Iter 1.000: -2.076271940612793
    Resources requested: 14/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT
    Number of trials: 10 (7 RUNNING, 3 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_79ae1_00000 | TERMINATED |                 |           16 |  256 |    8 | 0.000100905 | 2.3222  |     0.1017 |                    1 |
    | DEFAULT_79ae1_00001 | RUNNING    | 172.17.0.2:1136 |            4 |    4 |   64 | 0.00502624  | 1.76995 |     0.3275 |                    1 |
    | DEFAULT_79ae1_00002 | RUNNING    | 172.17.0.2:1101 |            8 |    8 |    8 | 0.000388007 | 2.07627 |     0.1955 |                    1 |
    | DEFAULT_79ae1_00003 | RUNNING    | 172.17.0.2:1088 |           16 |    4 |   32 | 0.0243759   | 2.30692 |     0.1002 |                    3 |
    | DEFAULT_79ae1_00004 | RUNNING    |                 |            2 |   32 |  128 | 0.00376088  |         |            |                      |
    | DEFAULT_79ae1_00005 | TERMINATED |                 |           16 |    8 |   32 | 0.0600091   | 2.30412 |     0.0997 |                    1 |
    | DEFAULT_79ae1_00006 | RUNNING    |                 |            2 |  128 |   64 | 0.0318437   |         |            |                      |
    | DEFAULT_79ae1_00007 | RUNNING    | 172.17.0.2:1082 |            8 |    8 |    8 | 0.00975354  | 1.79805 |     0.3078 |                    1 |
    | DEFAULT_79ae1_00008 | RUNNING    |                 |            2 |   64 |  128 | 0.00594678  |         |            |                      |
    | DEFAULT_79ae1_00009 | TERMINATED |                 |            8 |    8 |    4 | 0.000398399 | 2.30283 |     0.097  |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1090)[0m [1, 12000] loss: 0.390
    [2m[36m(pid=1081)[0m [1, 14000] loss: 0.289
    [2m[36m(pid=1093)[0m [1, 14000] loss: 0.266
    Result for DEFAULT_79ae1_00007:
      accuracy: 0.3027
      date: 2020-09-21_20-40-12
      done: false
      experiment_id: b968c158f8f04acfa889e6269e06743b
      experiment_tag: 7_batch_size=8,l1=8,l2=8,lr=0.0097535
      hostname: 18e16d8a13a6
      iterations_since_restore: 2
      loss: 1.8049614634513855
      node_ip: 172.17.0.2
      pid: 1082
      should_checkpoint: true
      time_since_restore: 72.9041838645935
      time_this_iter_s: 30.849170684814453
      time_total_s: 72.9041838645935
      timestamp: 1600720812
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: 79ae1_00007
  
    [2m[36m(pid=1136)[0m [2,  2000] loss: 1.805
    Result for DEFAULT_79ae1_00002:
      accuracy: 0.2801
      date: 2020-09-21_20-40-13
      done: false
      experiment_id: cfab037e3fcd473a92d773d729f383ed
      experiment_tag: 2_batch_size=8,l1=8,l2=8,lr=0.00038801
      hostname: 18e16d8a13a6
      iterations_since_restore: 2
      loss: 1.8522035459518433
      node_ip: 172.17.0.2
      pid: 1101
      should_checkpoint: true
      time_since_restore: 73.93428492546082
      time_this_iter_s: 31.5186505317688
      time_total_s: 73.93428492546082
      timestamp: 1600720813
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: 79ae1_00002
  
    [2m[36m(pid=1093)[0m [1, 16000] loss: 0.231
    [2m[36m(pid=1081)[0m [1, 16000] loss: 0.254
    [2m[36m(pid=1136)[0m [2,  4000] loss: 0.907
    [2m[36m(pid=1090)[0m [1, 14000] loss: 0.334
    [2m[36m(pid=1082)[0m [3,  2000] loss: 1.767
    [2m[36m(pid=1088)[0m [4,  2000] loss: 2.257
    [2m[36m(pid=1101)[0m [3,  2000] loss: 1.827
    [2m[36m(pid=1093)[0m [1, 18000] loss: 0.207
    [2m[36m(pid=1081)[0m [1, 18000] loss: 0.225
    Result for DEFAULT_79ae1_00003:
      accuracy: 0.1007
      date: 2020-09-21_20-40-30
      done: false
      experiment_id: 9946778a87714a4894cfc1180226834e
      experiment_tag: 3_batch_size=16,l1=4,l2=32,lr=0.024376
      hostname: 18e16d8a13a6
      iterations_since_restore: 4
      loss: 2.304528719711304
      node_ip: 172.17.0.2
      pid: 1088
      should_checkpoint: true
      time_since_restore: 90.63147377967834
      time_this_iter_s: 20.18751549720764
      time_total_s: 90.63147377967834
      timestamp: 1600720830
      timesteps_since_restore: 0
      training_iteration: 4
      trial_id: 79ae1_00003
  
    == Status ==
    Memory usage on this node: 7.2/240.1 GiB
    Using AsyncHyperBand: num_stopped=3
    Bracket: Iter 8.000: None | Iter 4.000: -2.304528719711304 | Iter 2.000: -1.8522035459518433 | Iter 1.000: -2.076271940612793
    Resources requested: 14/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT
    Number of trials: 10 (7 RUNNING, 3 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_79ae1_00000 | TERMINATED |                 |           16 |  256 |    8 | 0.000100905 | 2.3222  |     0.1017 |                    1 |
    | DEFAULT_79ae1_00001 | RUNNING    | 172.17.0.2:1136 |            4 |    4 |   64 | 0.00502624  | 1.76995 |     0.3275 |                    1 |
    | DEFAULT_79ae1_00002 | RUNNING    | 172.17.0.2:1101 |            8 |    8 |    8 | 0.000388007 | 1.8522  |     0.2801 |                    2 |
    | DEFAULT_79ae1_00003 | RUNNING    | 172.17.0.2:1088 |           16 |    4 |   32 | 0.0243759   | 2.30453 |     0.1007 |                    4 |
    | DEFAULT_79ae1_00004 | RUNNING    |                 |            2 |   32 |  128 | 0.00376088  |         |            |                      |
    | DEFAULT_79ae1_00005 | TERMINATED |                 |           16 |    8 |   32 | 0.0600091   | 2.30412 |     0.0997 |                    1 |
    | DEFAULT_79ae1_00006 | RUNNING    |                 |            2 |  128 |   64 | 0.0318437   |         |            |                      |
    | DEFAULT_79ae1_00007 | RUNNING    | 172.17.0.2:1082 |            8 |    8 |    8 | 0.00975354  | 1.80496 |     0.3027 |                    2 |
    | DEFAULT_79ae1_00008 | RUNNING    |                 |            2 |   64 |  128 | 0.00594678  |         |            |                      |
    | DEFAULT_79ae1_00009 | TERMINATED |                 |            8 |    8 |    4 | 0.000398399 | 2.30283 |     0.097  |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1136)[0m [2,  6000] loss: 0.600
    [2m[36m(pid=1090)[0m [1, 16000] loss: 0.293
    [2m[36m(pid=1082)[0m [3,  4000] loss: 0.903
    [2m[36m(pid=1101)[0m [3,  4000] loss: 0.887
    [2m[36m(pid=1093)[0m [1, 20000] loss: 0.187
    [2m[36m(pid=1081)[0m [1, 20000] loss: 0.202
    [2m[36m(pid=1136)[0m [2,  8000] loss: 0.454
    [2m[36m(pid=1090)[0m [1, 18000] loss: 0.260
    Result for DEFAULT_79ae1_00007:
      accuracy: 0.3178
      date: 2020-09-21_20-40-43
      done: false
      experiment_id: b968c158f8f04acfa889e6269e06743b
      experiment_tag: 7_batch_size=8,l1=8,l2=8,lr=0.0097535
      hostname: 18e16d8a13a6
      iterations_since_restore: 3
      loss: 1.7704263922214507
      node_ip: 172.17.0.2
      pid: 1082
      should_checkpoint: true
      time_since_restore: 103.74907493591309
      time_this_iter_s: 30.84489107131958
      time_total_s: 103.74907493591309
      timestamp: 1600720843
      timesteps_since_restore: 0
      training_iteration: 3
      trial_id: 79ae1_00007
  
    == Status ==
    Memory usage on this node: 7.2/240.1 GiB
    Using AsyncHyperBand: num_stopped=3
    Bracket: Iter 8.000: None | Iter 4.000: -2.304528719711304 | Iter 2.000: -1.8522035459518433 | Iter 1.000: -2.076271940612793
    Resources requested: 14/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT
    Number of trials: 10 (7 RUNNING, 3 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_79ae1_00000 | TERMINATED |                 |           16 |  256 |    8 | 0.000100905 | 2.3222  |     0.1017 |                    1 |
    | DEFAULT_79ae1_00001 | RUNNING    | 172.17.0.2:1136 |            4 |    4 |   64 | 0.00502624  | 1.76995 |     0.3275 |                    1 |
    | DEFAULT_79ae1_00002 | RUNNING    | 172.17.0.2:1101 |            8 |    8 |    8 | 0.000388007 | 1.8522  |     0.2801 |                    2 |
    | DEFAULT_79ae1_00003 | RUNNING    | 172.17.0.2:1088 |           16 |    4 |   32 | 0.0243759   | 2.30453 |     0.1007 |                    4 |
    | DEFAULT_79ae1_00004 | RUNNING    |                 |            2 |   32 |  128 | 0.00376088  |         |            |                      |
    | DEFAULT_79ae1_00005 | TERMINATED |                 |           16 |    8 |   32 | 0.0600091   | 2.30412 |     0.0997 |                    1 |
    | DEFAULT_79ae1_00006 | RUNNING    |                 |            2 |  128 |   64 | 0.0318437   |         |            |                      |
    | DEFAULT_79ae1_00007 | RUNNING    | 172.17.0.2:1082 |            8 |    8 |    8 | 0.00975354  | 1.77043 |     0.3178 |                    3 |
    | DEFAULT_79ae1_00008 | RUNNING    |                 |            2 |   64 |  128 | 0.00594678  |         |            |                      |
    | DEFAULT_79ae1_00009 | TERMINATED |                 |            8 |    8 |    4 | 0.000398399 | 2.30283 |     0.097  |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1088)[0m [5,  2000] loss: 2.303
    Result for DEFAULT_79ae1_00002:
      accuracy: 0.3288
      date: 2020-09-21_20-40-45
      done: false
      experiment_id: cfab037e3fcd473a92d773d729f383ed
      experiment_tag: 2_batch_size=8,l1=8,l2=8,lr=0.00038801
      hostname: 18e16d8a13a6
      iterations_since_restore: 3
      loss: 1.7250523057937621
      node_ip: 172.17.0.2
      pid: 1101
      should_checkpoint: true
      time_since_restore: 105.13578486442566
      time_this_iter_s: 31.201499938964844
      time_total_s: 105.13578486442566
      timestamp: 1600720845
      timesteps_since_restore: 0
      training_iteration: 3
      trial_id: 79ae1_00002
  
    [2m[36m(pid=1136)[0m [2, 10000] loss: 0.364
    Result for DEFAULT_79ae1_00003:
      accuracy: 0.109
      date: 2020-09-21_20-40-50
      done: false
      experiment_id: 9946778a87714a4894cfc1180226834e
      experiment_tag: 3_batch_size=16,l1=4,l2=32,lr=0.024376
      hostname: 18e16d8a13a6
      iterations_since_restore: 5
      loss: 2.2939017021179198
      node_ip: 172.17.0.2
      pid: 1088
      should_checkpoint: true
      time_since_restore: 111.0763897895813
      time_this_iter_s: 20.444916009902954
      time_total_s: 111.0763897895813
      timestamp: 1600720850
      timesteps_since_restore: 0
      training_iteration: 5
      trial_id: 79ae1_00003
  
    == Status ==
    Memory usage on this node: 7.2/240.1 GiB
    Using AsyncHyperBand: num_stopped=3
    Bracket: Iter 8.000: None | Iter 4.000: -2.304528719711304 | Iter 2.000: -1.8522035459518433 | Iter 1.000: -2.076271940612793
    Resources requested: 14/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT
    Number of trials: 10 (7 RUNNING, 3 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_79ae1_00000 | TERMINATED |                 |           16 |  256 |    8 | 0.000100905 | 2.3222  |     0.1017 |                    1 |
    | DEFAULT_79ae1_00001 | RUNNING    | 172.17.0.2:1136 |            4 |    4 |   64 | 0.00502624  | 1.76995 |     0.3275 |                    1 |
    | DEFAULT_79ae1_00002 | RUNNING    | 172.17.0.2:1101 |            8 |    8 |    8 | 0.000388007 | 1.72505 |     0.3288 |                    3 |
    | DEFAULT_79ae1_00003 | RUNNING    | 172.17.0.2:1088 |           16 |    4 |   32 | 0.0243759   | 2.2939  |     0.109  |                    5 |
    | DEFAULT_79ae1_00004 | RUNNING    |                 |            2 |   32 |  128 | 0.00376088  |         |            |                      |
    | DEFAULT_79ae1_00005 | TERMINATED |                 |           16 |    8 |   32 | 0.0600091   | 2.30412 |     0.0997 |                    1 |
    | DEFAULT_79ae1_00006 | RUNNING    |                 |            2 |  128 |   64 | 0.0318437   |         |            |                      |
    | DEFAULT_79ae1_00007 | RUNNING    | 172.17.0.2:1082 |            8 |    8 |    8 | 0.00975354  | 1.77043 |     0.3178 |                    3 |
    | DEFAULT_79ae1_00008 | RUNNING    |                 |            2 |   64 |  128 | 0.00594678  |         |            |                      |
    | DEFAULT_79ae1_00009 | TERMINATED |                 |            8 |    8 |    4 | 0.000398399 | 2.30283 |     0.097  |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_79ae1_00004:
      accuracy: 0.288
      date: 2020-09-21_20-40-51
      done: false
      experiment_id: e9f3bc460b5047efab2187cd37b38e02
      experiment_tag: 4_batch_size=2,l1=32,l2=128,lr=0.0037609
      hostname: 18e16d8a13a6
      iterations_since_restore: 1
      loss: 1.8948279816046356
      node_ip: 172.17.0.2
      pid: 1093
      should_checkpoint: true
      time_since_restore: 110.88702154159546
      time_this_iter_s: 110.88702154159546
      time_total_s: 110.88702154159546
      timestamp: 1600720851
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 79ae1_00004
  
    Result for DEFAULT_79ae1_00008:
      accuracy: 0.239
      date: 2020-09-21_20-40-52
      done: true
      experiment_id: 0530fda6dd354dd2b8c8d0f6db1c1aac
      experiment_tag: 8_batch_size=2,l1=64,l2=128,lr=0.0059468
      hostname: 18e16d8a13a6
      iterations_since_restore: 1
      loss: 2.018311379826069
      node_ip: 172.17.0.2
      pid: 1081
      should_checkpoint: true
      time_since_restore: 112.22666525840759
      time_this_iter_s: 112.22666525840759
      time_total_s: 112.22666525840759
      timestamp: 1600720852
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 79ae1_00008
  
    [2m[36m(pid=1090)[0m [1, 20000] loss: 0.234
    [2m[36m(pid=1082)[0m [4,  2000] loss: 1.760
    [2m[36m(pid=1101)[0m [4,  2000] loss: 1.702
    Result for DEFAULT_79ae1_00001:
      accuracy: 0.3383
      date: 2020-09-21_20-40-56
      done: false
      experiment_id: 1bbc7a7895e54fbcb940a03305b600d0
      experiment_tag: 1_batch_size=4,l1=4,l2=64,lr=0.0050262
      hostname: 18e16d8a13a6
      iterations_since_restore: 2
      loss: 1.7636220365047455
      node_ip: 172.17.0.2
      pid: 1136
      should_checkpoint: true
      time_since_restore: 117.04371237754822
      time_this_iter_s: 53.17508506774902
      time_total_s: 117.04371237754822
      timestamp: 1600720856
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: 79ae1_00001
  
    == Status ==
    Memory usage on this node: 6.7/240.1 GiB
    Using AsyncHyperBand: num_stopped=4
    Bracket: Iter 8.000: None | Iter 4.000: -2.304528719711304 | Iter 2.000: -1.8285825047016144 | Iter 1.000: -2.018311379826069
    Resources requested: 12/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT
    Number of trials: 10 (6 RUNNING, 4 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_79ae1_00000 | TERMINATED |                 |           16 |  256 |    8 | 0.000100905 | 2.3222  |     0.1017 |                    1 |
    | DEFAULT_79ae1_00001 | RUNNING    | 172.17.0.2:1136 |            4 |    4 |   64 | 0.00502624  | 1.76362 |     0.3383 |                    2 |
    | DEFAULT_79ae1_00002 | RUNNING    | 172.17.0.2:1101 |            8 |    8 |    8 | 0.000388007 | 1.72505 |     0.3288 |                    3 |
    | DEFAULT_79ae1_00003 | RUNNING    | 172.17.0.2:1088 |           16 |    4 |   32 | 0.0243759   | 2.2939  |     0.109  |                    5 |
    | DEFAULT_79ae1_00004 | RUNNING    | 172.17.0.2:1093 |            2 |   32 |  128 | 0.00376088  | 1.89483 |     0.288  |                    1 |
    | DEFAULT_79ae1_00005 | TERMINATED |                 |           16 |    8 |   32 | 0.0600091   | 2.30412 |     0.0997 |                    1 |
    | DEFAULT_79ae1_00006 | RUNNING    |                 |            2 |  128 |   64 | 0.0318437   |         |            |                      |
    | DEFAULT_79ae1_00007 | RUNNING    | 172.17.0.2:1082 |            8 |    8 |    8 | 0.00975354  | 1.77043 |     0.3178 |                    3 |
    | DEFAULT_79ae1_00008 | TERMINATED |                 |            2 |   64 |  128 | 0.00594678  | 2.01831 |     0.239  |                    1 |
    | DEFAULT_79ae1_00009 | TERMINATED |                 |            8 |    8 |    4 | 0.000398399 | 2.30283 |     0.097  |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1093)[0m [2,  2000] loss: 1.887
    [2m[36m(pid=1088)[0m [6,  2000] loss: 2.294
    [2m[36m(pid=1082)[0m [4,  4000] loss: 0.883
    Result for DEFAULT_79ae1_00006:
      accuracy: 0.1007
      date: 2020-09-21_20-41-05
      done: true
      experiment_id: 2663f80c02b64a159a00262d7f61fc4e
      experiment_tag: 6_batch_size=2,l1=128,l2=64,lr=0.031844
      hostname: 18e16d8a13a6
      iterations_since_restore: 1
      loss: 2.332287749695778
      node_ip: 172.17.0.2
      pid: 1090
      should_checkpoint: true
      time_since_restore: 125.71267557144165
      time_this_iter_s: 125.71267557144165
      time_total_s: 125.71267557144165
      timestamp: 1600720865
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 79ae1_00006
  
    == Status ==
    Memory usage on this node: 6.7/240.1 GiB
    Using AsyncHyperBand: num_stopped=5
    Bracket: Iter 8.000: None | Iter 4.000: -2.304528719711304 | Iter 2.000: -1.8285825047016144 | Iter 1.000: -2.047291660219431
    Resources requested: 12/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT
    Number of trials: 10 (6 RUNNING, 4 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_79ae1_00000 | TERMINATED |                 |           16 |  256 |    8 | 0.000100905 | 2.3222  |     0.1017 |                    1 |
    | DEFAULT_79ae1_00001 | RUNNING    | 172.17.0.2:1136 |            4 |    4 |   64 | 0.00502624  | 1.76362 |     0.3383 |                    2 |
    | DEFAULT_79ae1_00002 | RUNNING    | 172.17.0.2:1101 |            8 |    8 |    8 | 0.000388007 | 1.72505 |     0.3288 |                    3 |
    | DEFAULT_79ae1_00003 | RUNNING    | 172.17.0.2:1088 |           16 |    4 |   32 | 0.0243759   | 2.2939  |     0.109  |                    5 |
    | DEFAULT_79ae1_00004 | RUNNING    | 172.17.0.2:1093 |            2 |   32 |  128 | 0.00376088  | 1.89483 |     0.288  |                    1 |
    | DEFAULT_79ae1_00005 | TERMINATED |                 |           16 |    8 |   32 | 0.0600091   | 2.30412 |     0.0997 |                    1 |
    | DEFAULT_79ae1_00006 | RUNNING    | 172.17.0.2:1090 |            2 |  128 |   64 | 0.0318437   | 2.33229 |     0.1007 |                    1 |
    | DEFAULT_79ae1_00007 | RUNNING    | 172.17.0.2:1082 |            8 |    8 |    8 | 0.00975354  | 1.77043 |     0.3178 |                    3 |
    | DEFAULT_79ae1_00008 | TERMINATED |                 |            2 |   64 |  128 | 0.00594678  | 2.01831 |     0.239  |                    1 |
    | DEFAULT_79ae1_00009 | TERMINATED |                 |            8 |    8 |    4 | 0.000398399 | 2.30283 |     0.097  |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1136)[0m [3,  2000] loss: 1.805
    [2m[36m(pid=1101)[0m [4,  4000] loss: 0.836
    [2m[36m(pid=1093)[0m [2,  4000] loss: 0.931
    Result for DEFAULT_79ae1_00003:
      accuracy: 0.1068
      date: 2020-09-21_20-41-10
      done: false
      experiment_id: 9946778a87714a4894cfc1180226834e
      experiment_tag: 3_batch_size=16,l1=4,l2=32,lr=0.024376
      hostname: 18e16d8a13a6
      iterations_since_restore: 6
      loss: 2.2975869762420653
      node_ip: 172.17.0.2
      pid: 1088
      should_checkpoint: true
      time_since_restore: 130.60929155349731
      time_this_iter_s: 19.532901763916016
      time_total_s: 130.60929155349731
      timestamp: 1600720870
      timesteps_since_restore: 0
      training_iteration: 6
      trial_id: 79ae1_00003
  
    Result for DEFAULT_79ae1_00007:
      accuracy: 0.2908
      date: 2020-09-21_20-41-13
      done: false
      experiment_id: b968c158f8f04acfa889e6269e06743b
      experiment_tag: 7_batch_size=8,l1=8,l2=8,lr=0.0097535
      hostname: 18e16d8a13a6
      iterations_since_restore: 4
      loss: 1.9331315527915955
      node_ip: 172.17.0.2
      pid: 1082
      should_checkpoint: true
      time_since_restore: 133.94267892837524
      time_this_iter_s: 30.193603992462158
      time_total_s: 133.94267892837524
      timestamp: 1600720873
      timesteps_since_restore: 0
      training_iteration: 4
      trial_id: 79ae1_00007
  
    == Status ==
    Memory usage on this node: 6.2/240.1 GiB
    Using AsyncHyperBand: num_stopped=5
    Bracket: Iter 8.000: None | Iter 4.000: -2.1188301362514497 | Iter 2.000: -1.8285825047016144 | Iter 1.000: -2.047291660219431
    Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT
    Number of trials: 10 (5 RUNNING, 5 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_79ae1_00000 | TERMINATED |                 |           16 |  256 |    8 | 0.000100905 | 2.3222  |     0.1017 |                    1 |
    | DEFAULT_79ae1_00001 | RUNNING    | 172.17.0.2:1136 |            4 |    4 |   64 | 0.00502624  | 1.76362 |     0.3383 |                    2 |
    | DEFAULT_79ae1_00002 | RUNNING    | 172.17.0.2:1101 |            8 |    8 |    8 | 0.000388007 | 1.72505 |     0.3288 |                    3 |
    | DEFAULT_79ae1_00003 | RUNNING    | 172.17.0.2:1088 |           16 |    4 |   32 | 0.0243759   | 2.29759 |     0.1068 |                    6 |
    | DEFAULT_79ae1_00004 | RUNNING    | 172.17.0.2:1093 |            2 |   32 |  128 | 0.00376088  | 1.89483 |     0.288  |                    1 |
    | DEFAULT_79ae1_00005 | TERMINATED |                 |           16 |    8 |   32 | 0.0600091   | 2.30412 |     0.0997 |                    1 |
    | DEFAULT_79ae1_00006 | TERMINATED |                 |            2 |  128 |   64 | 0.0318437   | 2.33229 |     0.1007 |                    1 |
    | DEFAULT_79ae1_00007 | RUNNING    | 172.17.0.2:1082 |            8 |    8 |    8 | 0.00975354  | 1.93313 |     0.2908 |                    4 |
    | DEFAULT_79ae1_00008 | TERMINATED |                 |            2 |   64 |  128 | 0.00594678  | 2.01831 |     0.239  |                    1 |
    | DEFAULT_79ae1_00009 | TERMINATED |                 |            8 |    8 |    4 | 0.000398399 | 2.30283 |     0.097  |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1136)[0m [3,  4000] loss: 0.908
    Result for DEFAULT_79ae1_00002:
      accuracy: 0.3629
      date: 2020-09-21_20-41-15
      done: false
      experiment_id: cfab037e3fcd473a92d773d729f383ed
      experiment_tag: 2_batch_size=8,l1=8,l2=8,lr=0.00038801
      hostname: 18e16d8a13a6
      iterations_since_restore: 4
      loss: 1.634586717891693
      node_ip: 172.17.0.2
      pid: 1101
      should_checkpoint: true
      time_since_restore: 135.4520401954651
      time_this_iter_s: 30.31625533103943
      time_total_s: 135.4520401954651
      timestamp: 1600720875
      timesteps_since_restore: 0
      training_iteration: 4
      trial_id: 79ae1_00002
  
    [2m[36m(pid=1093)[0m [2,  6000] loss: 0.623
    [2m[36m(pid=1136)[0m [3,  6000] loss: 0.614
    [2m[36m(pid=1088)[0m [7,  2000] loss: 2.295
    [2m[36m(pid=1082)[0m [5,  2000] loss: 1.774
    [2m[36m(pid=1093)[0m [2,  8000] loss: 0.466
    [2m[36m(pid=1101)[0m [5,  2000] loss: 1.616
    Result for DEFAULT_79ae1_00003:
      accuracy: 0.1024
      date: 2020-09-21_20-41-29
      done: false
      experiment_id: 9946778a87714a4894cfc1180226834e
      experiment_tag: 3_batch_size=16,l1=4,l2=32,lr=0.024376
      hostname: 18e16d8a13a6
      iterations_since_restore: 7
      loss: 2.3021462203979493
      node_ip: 172.17.0.2
      pid: 1088
      should_checkpoint: true
      time_since_restore: 149.9416379928589
      time_this_iter_s: 19.332346439361572
      time_total_s: 149.9416379928589
      timestamp: 1600720889
      timesteps_since_restore: 0
      training_iteration: 7
      trial_id: 79ae1_00003
  
    == Status ==
    Memory usage on this node: 6.1/240.1 GiB
    Using AsyncHyperBand: num_stopped=5
    Bracket: Iter 8.000: None | Iter 4.000: -1.9331315527915955 | Iter 2.000: -1.8285825047016144 | Iter 1.000: -2.047291660219431
    Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT
    Number of trials: 10 (5 RUNNING, 5 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_79ae1_00000 | TERMINATED |                 |           16 |  256 |    8 | 0.000100905 | 2.3222  |     0.1017 |                    1 |
    | DEFAULT_79ae1_00001 | RUNNING    | 172.17.0.2:1136 |            4 |    4 |   64 | 0.00502624  | 1.76362 |     0.3383 |                    2 |
    | DEFAULT_79ae1_00002 | RUNNING    | 172.17.0.2:1101 |            8 |    8 |    8 | 0.000388007 | 1.63459 |     0.3629 |                    4 |
    | DEFAULT_79ae1_00003 | RUNNING    | 172.17.0.2:1088 |           16 |    4 |   32 | 0.0243759   | 2.30215 |     0.1024 |                    7 |
    | DEFAULT_79ae1_00004 | RUNNING    | 172.17.0.2:1093 |            2 |   32 |  128 | 0.00376088  | 1.89483 |     0.288  |                    1 |
    | DEFAULT_79ae1_00005 | TERMINATED |                 |           16 |    8 |   32 | 0.0600091   | 2.30412 |     0.0997 |                    1 |
    | DEFAULT_79ae1_00006 | TERMINATED |                 |            2 |  128 |   64 | 0.0318437   | 2.33229 |     0.1007 |                    1 |
    | DEFAULT_79ae1_00007 | RUNNING    | 172.17.0.2:1082 |            8 |    8 |    8 | 0.00975354  | 1.93313 |     0.2908 |                    4 |
    | DEFAULT_79ae1_00008 | TERMINATED |                 |            2 |   64 |  128 | 0.00594678  | 2.01831 |     0.239  |                    1 |
    | DEFAULT_79ae1_00009 | TERMINATED |                 |            8 |    8 |    4 | 0.000398399 | 2.30283 |     0.097  |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1136)[0m [3,  8000] loss: 0.459
    [2m[36m(pid=1093)[0m [2, 10000] loss: 0.374
    [2m[36m(pid=1082)[0m [5,  4000] loss: 0.894
    [2m[36m(pid=1101)[0m [5,  4000] loss: 0.800
    [2m[36m(pid=1136)[0m [3, 10000] loss: 0.393
    [2m[36m(pid=1093)[0m [2, 12000] loss: 0.314
    Result for DEFAULT_79ae1_00007:
      accuracy: 0.3437
      date: 2020-09-21_20-41-43
      done: false
      experiment_id: b968c158f8f04acfa889e6269e06743b
      experiment_tag: 7_batch_size=8,l1=8,l2=8,lr=0.0097535
      hostname: 18e16d8a13a6
      iterations_since_restore: 5
      loss: 1.7956827806949616
      node_ip: 172.17.0.2
      pid: 1082
      should_checkpoint: true
      time_since_restore: 163.26087045669556
      time_this_iter_s: 29.318191528320312
      time_total_s: 163.26087045669556
      timestamp: 1600720903
      timesteps_since_restore: 0
      training_iteration: 5
      trial_id: 79ae1_00007
  
    == Status ==
    Memory usage on this node: 6.1/240.1 GiB
    Using AsyncHyperBand: num_stopped=5
    Bracket: Iter 8.000: None | Iter 4.000: -1.9331315527915955 | Iter 2.000: -1.8285825047016144 | Iter 1.000: -2.047291660219431
    Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT
    Number of trials: 10 (5 RUNNING, 5 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_79ae1_00000 | TERMINATED |                 |           16 |  256 |    8 | 0.000100905 | 2.3222  |     0.1017 |                    1 |
    | DEFAULT_79ae1_00001 | RUNNING    | 172.17.0.2:1136 |            4 |    4 |   64 | 0.00502624  | 1.76362 |     0.3383 |                    2 |
    | DEFAULT_79ae1_00002 | RUNNING    | 172.17.0.2:1101 |            8 |    8 |    8 | 0.000388007 | 1.63459 |     0.3629 |                    4 |
    | DEFAULT_79ae1_00003 | RUNNING    | 172.17.0.2:1088 |           16 |    4 |   32 | 0.0243759   | 2.30215 |     0.1024 |                    7 |
    | DEFAULT_79ae1_00004 | RUNNING    | 172.17.0.2:1093 |            2 |   32 |  128 | 0.00376088  | 1.89483 |     0.288  |                    1 |
    | DEFAULT_79ae1_00005 | TERMINATED |                 |           16 |    8 |   32 | 0.0600091   | 2.30412 |     0.0997 |                    1 |
    | DEFAULT_79ae1_00006 | TERMINATED |                 |            2 |  128 |   64 | 0.0318437   | 2.33229 |     0.1007 |                    1 |
    | DEFAULT_79ae1_00007 | RUNNING    | 172.17.0.2:1082 |            8 |    8 |    8 | 0.00975354  | 1.79568 |     0.3437 |                    5 |
    | DEFAULT_79ae1_00008 | TERMINATED |                 |            2 |   64 |  128 | 0.00594678  | 2.01831 |     0.239  |                    1 |
    | DEFAULT_79ae1_00009 | TERMINATED |                 |            8 |    8 |    4 | 0.000398399 | 2.30283 |     0.097  |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1088)[0m [8,  2000] loss: 2.301
    Result for DEFAULT_79ae1_00002:
      accuracy: 0.396
      date: 2020-09-21_20-41-45
      done: false
      experiment_id: cfab037e3fcd473a92d773d729f383ed
      experiment_tag: 2_batch_size=8,l1=8,l2=8,lr=0.00038801
      hostname: 18e16d8a13a6
      iterations_since_restore: 5
      loss: 1.5581882798194886
      node_ip: 172.17.0.2
      pid: 1101
      should_checkpoint: true
      time_since_restore: 165.59167218208313
      time_this_iter_s: 30.139631986618042
      time_total_s: 165.59167218208313
      timestamp: 1600720905
      timesteps_since_restore: 0
      training_iteration: 5
      trial_id: 79ae1_00002
  
    Result for DEFAULT_79ae1_00001:
      accuracy: 0.2787
      date: 2020-09-21_20-41-46
      done: false
      experiment_id: 1bbc7a7895e54fbcb940a03305b600d0
      experiment_tag: 1_batch_size=4,l1=4,l2=64,lr=0.0050262
      hostname: 18e16d8a13a6
      iterations_since_restore: 3
      loss: 1.9169371470928191
      node_ip: 172.17.0.2
      pid: 1136
      should_checkpoint: true
      time_since_restore: 166.80613708496094
      time_this_iter_s: 49.76242470741272
      time_total_s: 166.80613708496094
      timestamp: 1600720906
      timesteps_since_restore: 0
      training_iteration: 3
      trial_id: 79ae1_00001
  
    [2m[36m(pid=1093)[0m [2, 14000] loss: 0.266
    Result for DEFAULT_79ae1_00003:
      accuracy: 0.1048
      date: 2020-09-21_20-41-49
      done: false
      experiment_id: 9946778a87714a4894cfc1180226834e
      experiment_tag: 3_batch_size=16,l1=4,l2=32,lr=0.024376
      hostname: 18e16d8a13a6
      iterations_since_restore: 8
      loss: 2.299399206161499
      node_ip: 172.17.0.2
      pid: 1088
      should_checkpoint: true
      time_since_restore: 169.2664031982422
      time_this_iter_s: 19.3247652053833
      time_total_s: 169.2664031982422
      timestamp: 1600720909
      timesteps_since_restore: 0
      training_iteration: 8
      trial_id: 79ae1_00003
  
    == Status ==
    Memory usage on this node: 6.1/240.1 GiB
    Using AsyncHyperBand: num_stopped=5
    Bracket: Iter 8.000: -2.299399206161499 | Iter 4.000: -1.9331315527915955 | Iter 2.000: -1.8285825047016144 | Iter 1.000: -2.047291660219431
    Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT
    Number of trials: 10 (5 RUNNING, 5 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_79ae1_00000 | TERMINATED |                 |           16 |  256 |    8 | 0.000100905 | 2.3222  |     0.1017 |                    1 |
    | DEFAULT_79ae1_00001 | RUNNING    | 172.17.0.2:1136 |            4 |    4 |   64 | 0.00502624  | 1.91694 |     0.2787 |                    3 |
    | DEFAULT_79ae1_00002 | RUNNING    | 172.17.0.2:1101 |            8 |    8 |    8 | 0.000388007 | 1.55819 |     0.396  |                    5 |
    | DEFAULT_79ae1_00003 | RUNNING    | 172.17.0.2:1088 |           16 |    4 |   32 | 0.0243759   | 2.2994  |     0.1048 |                    8 |
    | DEFAULT_79ae1_00004 | RUNNING    | 172.17.0.2:1093 |            2 |   32 |  128 | 0.00376088  | 1.89483 |     0.288  |                    1 |
    | DEFAULT_79ae1_00005 | TERMINATED |                 |           16 |    8 |   32 | 0.0600091   | 2.30412 |     0.0997 |                    1 |
    | DEFAULT_79ae1_00006 | TERMINATED |                 |            2 |  128 |   64 | 0.0318437   | 2.33229 |     0.1007 |                    1 |
    | DEFAULT_79ae1_00007 | RUNNING    | 172.17.0.2:1082 |            8 |    8 |    8 | 0.00975354  | 1.79568 |     0.3437 |                    5 |
    | DEFAULT_79ae1_00008 | TERMINATED |                 |            2 |   64 |  128 | 0.00594678  | 2.01831 |     0.239  |                    1 |
    | DEFAULT_79ae1_00009 | TERMINATED |                 |            8 |    8 |    4 | 0.000398399 | 2.30283 |     0.097  |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1082)[0m [6,  2000] loss: 1.807
    [2m[36m(pid=1136)[0m [4,  2000] loss: 1.946
    [2m[36m(pid=1101)[0m [6,  2000] loss: 1.555
    [2m[36m(pid=1093)[0m [2, 16000] loss: 0.238
    [2m[36m(pid=1088)[0m [9,  2000] loss: 2.300
    [2m[36m(pid=1136)[0m [4,  4000] loss: 0.982
    [2m[36m(pid=1082)[0m [6,  4000] loss: 0.914
    [2m[36m(pid=1093)[0m [2, 18000] loss: 0.209
    [2m[36m(pid=1101)[0m [6,  4000] loss: 0.771
    Result for DEFAULT_79ae1_00003:
      accuracy: 0.1
      date: 2020-09-21_20-42-08
      done: false
      experiment_id: 9946778a87714a4894cfc1180226834e
      experiment_tag: 3_batch_size=16,l1=4,l2=32,lr=0.024376
      hostname: 18e16d8a13a6
      iterations_since_restore: 9
      loss: 2.29986978225708
      node_ip: 172.17.0.2
      pid: 1088
      should_checkpoint: true
      time_since_restore: 188.21875143051147
      time_this_iter_s: 18.952348232269287
      time_total_s: 188.21875143051147
      timestamp: 1600720928
      timesteps_since_restore: 0
      training_iteration: 9
      trial_id: 79ae1_00003
  
    == Status ==
    Memory usage on this node: 6.1/240.1 GiB
    Using AsyncHyperBand: num_stopped=5
    Bracket: Iter 8.000: -2.299399206161499 | Iter 4.000: -1.9331315527915955 | Iter 2.000: -1.8285825047016144 | Iter 1.000: -2.047291660219431
    Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT
    Number of trials: 10 (5 RUNNING, 5 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_79ae1_00000 | TERMINATED |                 |           16 |  256 |    8 | 0.000100905 | 2.3222  |     0.1017 |                    1 |
    | DEFAULT_79ae1_00001 | RUNNING    | 172.17.0.2:1136 |            4 |    4 |   64 | 0.00502624  | 1.91694 |     0.2787 |                    3 |
    | DEFAULT_79ae1_00002 | RUNNING    | 172.17.0.2:1101 |            8 |    8 |    8 | 0.000388007 | 1.55819 |     0.396  |                    5 |
    | DEFAULT_79ae1_00003 | RUNNING    | 172.17.0.2:1088 |           16 |    4 |   32 | 0.0243759   | 2.29987 |     0.1    |                    9 |
    | DEFAULT_79ae1_00004 | RUNNING    | 172.17.0.2:1093 |            2 |   32 |  128 | 0.00376088  | 1.89483 |     0.288  |                    1 |
    | DEFAULT_79ae1_00005 | TERMINATED |                 |           16 |    8 |   32 | 0.0600091   | 2.30412 |     0.0997 |                    1 |
    | DEFAULT_79ae1_00006 | TERMINATED |                 |            2 |  128 |   64 | 0.0318437   | 2.33229 |     0.1007 |                    1 |
    | DEFAULT_79ae1_00007 | RUNNING    | 172.17.0.2:1082 |            8 |    8 |    8 | 0.00975354  | 1.79568 |     0.3437 |                    5 |
    | DEFAULT_79ae1_00008 | TERMINATED |                 |            2 |   64 |  128 | 0.00594678  | 2.01831 |     0.239  |                    1 |
    | DEFAULT_79ae1_00009 | TERMINATED |                 |            8 |    8 |    4 | 0.000398399 | 2.30283 |     0.097  |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1136)[0m [4,  6000] loss: 0.702
    [2m[36m(pid=1093)[0m [2, 20000] loss: 0.191
    Result for DEFAULT_79ae1_00007:
      accuracy: 0.3048
      date: 2020-09-21_20-42-12
      done: false
      experiment_id: b968c158f8f04acfa889e6269e06743b
      experiment_tag: 7_batch_size=8,l1=8,l2=8,lr=0.0097535
      hostname: 18e16d8a13a6
      iterations_since_restore: 6
      loss: 1.8979502903938295
      node_ip: 172.17.0.2
      pid: 1082
      should_checkpoint: true
      time_since_restore: 192.96437525749207
      time_this_iter_s: 29.70350480079651
      time_total_s: 192.96437525749207
      timestamp: 1600720932
      timesteps_since_restore: 0
      training_iteration: 6
      trial_id: 79ae1_00007
  
    Result for DEFAULT_79ae1_00002:
      accuracy: 0.4114
      date: 2020-09-21_20-42-15
      done: false
      experiment_id: cfab037e3fcd473a92d773d729f383ed
      experiment_tag: 2_batch_size=8,l1=8,l2=8,lr=0.00038801
      hostname: 18e16d8a13a6
      iterations_since_restore: 6
      loss: 1.5554904752731322
      node_ip: 172.17.0.2
      pid: 1101
      should_checkpoint: true
      time_since_restore: 195.11810111999512
      time_this_iter_s: 29.526428937911987
      time_total_s: 195.11810111999512
      timestamp: 1600720935
      timesteps_since_restore: 0
      training_iteration: 6
      trial_id: 79ae1_00002
  
    == Status ==
    Memory usage on this node: 6.1/240.1 GiB
    Using AsyncHyperBand: num_stopped=5
    Bracket: Iter 8.000: -2.299399206161499 | Iter 4.000: -1.9331315527915955 | Iter 2.000: -1.8285825047016144 | Iter 1.000: -2.047291660219431
    Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT
    Number of trials: 10 (5 RUNNING, 5 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_79ae1_00000 | TERMINATED |                 |           16 |  256 |    8 | 0.000100905 | 2.3222  |     0.1017 |                    1 |
    | DEFAULT_79ae1_00001 | RUNNING    | 172.17.0.2:1136 |            4 |    4 |   64 | 0.00502624  | 1.91694 |     0.2787 |                    3 |
    | DEFAULT_79ae1_00002 | RUNNING    | 172.17.0.2:1101 |            8 |    8 |    8 | 0.000388007 | 1.55549 |     0.4114 |                    6 |
    | DEFAULT_79ae1_00003 | RUNNING    | 172.17.0.2:1088 |           16 |    4 |   32 | 0.0243759   | 2.29987 |     0.1    |                    9 |
    | DEFAULT_79ae1_00004 | RUNNING    | 172.17.0.2:1093 |            2 |   32 |  128 | 0.00376088  | 1.89483 |     0.288  |                    1 |
    | DEFAULT_79ae1_00005 | TERMINATED |                 |           16 |    8 |   32 | 0.0600091   | 2.30412 |     0.0997 |                    1 |
    | DEFAULT_79ae1_00006 | TERMINATED |                 |            2 |  128 |   64 | 0.0318437   | 2.33229 |     0.1007 |                    1 |
    | DEFAULT_79ae1_00007 | RUNNING    | 172.17.0.2:1082 |            8 |    8 |    8 | 0.00975354  | 1.89795 |     0.3048 |                    6 |
    | DEFAULT_79ae1_00008 | TERMINATED |                 |            2 |   64 |  128 | 0.00594678  | 2.01831 |     0.239  |                    1 |
    | DEFAULT_79ae1_00009 | TERMINATED |                 |            8 |    8 |    4 | 0.000398399 | 2.30283 |     0.097  |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1136)[0m [4,  8000] loss: 0.563
    [2m[36m(pid=1088)[0m [10,  2000] loss: 2.300
    [2m[36m(pid=1082)[0m [7,  2000] loss: 1.806
    Result for DEFAULT_79ae1_00004:
      accuracy: 0.2907
      date: 2020-09-21_20-42-24
      done: true
      experiment_id: e9f3bc460b5047efab2187cd37b38e02
      experiment_tag: 4_batch_size=2,l1=32,l2=128,lr=0.0037609
      hostname: 18e16d8a13a6
      iterations_since_restore: 2
      loss: 1.8536756362900138
      node_ip: 172.17.0.2
      pid: 1093
      should_checkpoint: true
      time_since_restore: 204.36427283287048
      time_this_iter_s: 93.47725129127502
      time_total_s: 204.36427283287048
      timestamp: 1600720944
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: 79ae1_00004
  
    == Status ==
    Memory usage on this node: 6.2/240.1 GiB
    Using AsyncHyperBand: num_stopped=6
    Bracket: Iter 8.000: -2.299399206161499 | Iter 4.000: -1.9331315527915955 | Iter 2.000: -1.8522035459518433 | Iter 1.000: -2.047291660219431
    Resources requested: 10/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT
    Number of trials: 10 (5 RUNNING, 5 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_79ae1_00000 | TERMINATED |                 |           16 |  256 |    8 | 0.000100905 | 2.3222  |     0.1017 |                    1 |
    | DEFAULT_79ae1_00001 | RUNNING    | 172.17.0.2:1136 |            4 |    4 |   64 | 0.00502624  | 1.91694 |     0.2787 |                    3 |
    | DEFAULT_79ae1_00002 | RUNNING    | 172.17.0.2:1101 |            8 |    8 |    8 | 0.000388007 | 1.55549 |     0.4114 |                    6 |
    | DEFAULT_79ae1_00003 | RUNNING    | 172.17.0.2:1088 |           16 |    4 |   32 | 0.0243759   | 2.29987 |     0.1    |                    9 |
    | DEFAULT_79ae1_00004 | RUNNING    | 172.17.0.2:1093 |            2 |   32 |  128 | 0.00376088  | 1.85368 |     0.2907 |                    2 |
    | DEFAULT_79ae1_00005 | TERMINATED |                 |           16 |    8 |   32 | 0.0600091   | 2.30412 |     0.0997 |                    1 |
    | DEFAULT_79ae1_00006 | TERMINATED |                 |            2 |  128 |   64 | 0.0318437   | 2.33229 |     0.1007 |                    1 |
    | DEFAULT_79ae1_00007 | RUNNING    | 172.17.0.2:1082 |            8 |    8 |    8 | 0.00975354  | 1.89795 |     0.3048 |                    6 |
    | DEFAULT_79ae1_00008 | TERMINATED |                 |            2 |   64 |  128 | 0.00594678  | 2.01831 |     0.239  |                    1 |
    | DEFAULT_79ae1_00009 | TERMINATED |                 |            8 |    8 |    4 | 0.000398399 | 2.30283 |     0.097  |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1101)[0m [7,  2000] loss: 1.489
    Result for DEFAULT_79ae1_00003:
      accuracy: 0.1039
      date: 2020-09-21_20-42-27
      done: true
      experiment_id: 9946778a87714a4894cfc1180226834e
      experiment_tag: 3_batch_size=16,l1=4,l2=32,lr=0.024376
      hostname: 18e16d8a13a6
      iterations_since_restore: 10
      loss: 2.301052016067505
      node_ip: 172.17.0.2
      pid: 1088
      should_checkpoint: true
      time_since_restore: 207.60384130477905
      time_this_iter_s: 19.385089874267578
      time_total_s: 207.60384130477905
      timestamp: 1600720947
      timesteps_since_restore: 0
      training_iteration: 10
      trial_id: 79ae1_00003
  
    [2m[36m(pid=1136)[0m [4, 10000] loss: 0.456
    [2m[36m(pid=1082)[0m [7,  4000] loss: 0.946
    [2m[36m(pid=1101)[0m [7,  4000] loss: 0.751
    Result for DEFAULT_79ae1_00001:
      accuracy: 0.1038
      date: 2020-09-21_20-42-36
      done: true
      experiment_id: 1bbc7a7895e54fbcb940a03305b600d0
      experiment_tag: 1_batch_size=4,l1=4,l2=64,lr=0.0050262
      hostname: 18e16d8a13a6
      iterations_since_restore: 4
      loss: 2.301591167116165
      node_ip: 172.17.0.2
      pid: 1136
      should_checkpoint: true
      time_since_restore: 216.5272274017334
      time_this_iter_s: 49.72109031677246
      time_total_s: 216.5272274017334
      timestamp: 1600720956
      timesteps_since_restore: 0
      training_iteration: 4
      trial_id: 79ae1_00001
  
    == Status ==
    Memory usage on this node: 5.2/240.1 GiB
    Using AsyncHyperBand: num_stopped=8
    Bracket: Iter 8.000: -2.299399206161499 | Iter 4.000: -2.1173613599538803 | Iter 2.000: -1.8522035459518433 | Iter 1.000: -2.047291660219431
    Resources requested: 6/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT
    Number of trials: 10 (3 RUNNING, 7 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_79ae1_00000 | TERMINATED |                 |           16 |  256 |    8 | 0.000100905 | 2.3222  |     0.1017 |                    1 |
    | DEFAULT_79ae1_00001 | RUNNING    | 172.17.0.2:1136 |            4 |    4 |   64 | 0.00502624  | 2.30159 |     0.1038 |                    4 |
    | DEFAULT_79ae1_00002 | RUNNING    | 172.17.0.2:1101 |            8 |    8 |    8 | 0.000388007 | 1.55549 |     0.4114 |                    6 |
    | DEFAULT_79ae1_00003 | TERMINATED |                 |           16 |    4 |   32 | 0.0243759   | 2.30105 |     0.1039 |                   10 |
    | DEFAULT_79ae1_00004 | TERMINATED |                 |            2 |   32 |  128 | 0.00376088  | 1.85368 |     0.2907 |                    2 |
    | DEFAULT_79ae1_00005 | TERMINATED |                 |           16 |    8 |   32 | 0.0600091   | 2.30412 |     0.0997 |                    1 |
    | DEFAULT_79ae1_00006 | TERMINATED |                 |            2 |  128 |   64 | 0.0318437   | 2.33229 |     0.1007 |                    1 |
    | DEFAULT_79ae1_00007 | RUNNING    | 172.17.0.2:1082 |            8 |    8 |    8 | 0.00975354  | 1.89795 |     0.3048 |                    6 |
    | DEFAULT_79ae1_00008 | TERMINATED |                 |            2 |   64 |  128 | 0.00594678  | 2.01831 |     0.239  |                    1 |
    | DEFAULT_79ae1_00009 | TERMINATED |                 |            8 |    8 |    4 | 0.000398399 | 2.30283 |     0.097  |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_79ae1_00007:
      accuracy: 0.2869
      date: 2020-09-21_20-42-41
      done: false
      experiment_id: b968c158f8f04acfa889e6269e06743b
      experiment_tag: 7_batch_size=8,l1=8,l2=8,lr=0.0097535
      hostname: 18e16d8a13a6
      iterations_since_restore: 7
      loss: 1.957276029586792
      node_ip: 172.17.0.2
      pid: 1082
      should_checkpoint: true
      time_since_restore: 221.83797359466553
      time_this_iter_s: 28.873598337173462
      time_total_s: 221.83797359466553
      timestamp: 1600720961
      timesteps_since_restore: 0
      training_iteration: 7
      trial_id: 79ae1_00007
  
    == Status ==
    Memory usage on this node: 4.6/240.1 GiB
    Using AsyncHyperBand: num_stopped=8
    Bracket: Iter 8.000: -2.299399206161499 | Iter 4.000: -2.1173613599538803 | Iter 2.000: -1.8522035459518433 | Iter 1.000: -2.047291660219431
    Resources requested: 4/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT
    Number of trials: 10 (2 RUNNING, 8 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_79ae1_00000 | TERMINATED |                 |           16 |  256 |    8 | 0.000100905 | 2.3222  |     0.1017 |                    1 |
    | DEFAULT_79ae1_00001 | TERMINATED |                 |            4 |    4 |   64 | 0.00502624  | 2.30159 |     0.1038 |                    4 |
    | DEFAULT_79ae1_00002 | RUNNING    | 172.17.0.2:1101 |            8 |    8 |    8 | 0.000388007 | 1.55549 |     0.4114 |                    6 |
    | DEFAULT_79ae1_00003 | TERMINATED |                 |           16 |    4 |   32 | 0.0243759   | 2.30105 |     0.1039 |                   10 |
    | DEFAULT_79ae1_00004 | TERMINATED |                 |            2 |   32 |  128 | 0.00376088  | 1.85368 |     0.2907 |                    2 |
    | DEFAULT_79ae1_00005 | TERMINATED |                 |           16 |    8 |   32 | 0.0600091   | 2.30412 |     0.0997 |                    1 |
    | DEFAULT_79ae1_00006 | TERMINATED |                 |            2 |  128 |   64 | 0.0318437   | 2.33229 |     0.1007 |                    1 |
    | DEFAULT_79ae1_00007 | RUNNING    | 172.17.0.2:1082 |            8 |    8 |    8 | 0.00975354  | 1.95728 |     0.2869 |                    7 |
    | DEFAULT_79ae1_00008 | TERMINATED |                 |            2 |   64 |  128 | 0.00594678  | 2.01831 |     0.239  |                    1 |
    | DEFAULT_79ae1_00009 | TERMINATED |                 |            8 |    8 |    4 | 0.000398399 | 2.30283 |     0.097  |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_79ae1_00002:
      accuracy: 0.4388
      date: 2020-09-21_20-42-43
      done: false
      experiment_id: cfab037e3fcd473a92d773d729f383ed
      experiment_tag: 2_batch_size=8,l1=8,l2=8,lr=0.00038801
      hostname: 18e16d8a13a6
      iterations_since_restore: 7
      loss: 1.4743298194885255
      node_ip: 172.17.0.2
      pid: 1101
      should_checkpoint: true
      time_since_restore: 223.82499742507935
      time_this_iter_s: 28.70689630508423
      time_total_s: 223.82499742507935
      timestamp: 1600720963
      timesteps_since_restore: 0
      training_iteration: 7
      trial_id: 79ae1_00002
  
    [2m[36m(pid=1082)[0m [8,  2000] loss: 1.935
    [2m[36m(pid=1101)[0m [8,  2000] loss: 1.467
    [2m[36m(pid=1082)[0m [8,  4000] loss: 0.976
    [2m[36m(pid=1101)[0m [8,  4000] loss: 0.726
    Result for DEFAULT_79ae1_00007:
      accuracy: 0.2025
      date: 2020-09-21_20-43-09
      done: false
      experiment_id: b968c158f8f04acfa889e6269e06743b
      experiment_tag: 7_batch_size=8,l1=8,l2=8,lr=0.0097535
      hostname: 18e16d8a13a6
      iterations_since_restore: 8
      loss: 2.103267540740967
      node_ip: 172.17.0.2
      pid: 1082
      should_checkpoint: true
      time_since_restore: 249.8705985546112
      time_this_iter_s: 28.03262495994568
      time_total_s: 249.8705985546112
      timestamp: 1600720989
      timesteps_since_restore: 0
      training_iteration: 8
      trial_id: 79ae1_00007
  
    == Status ==
    Memory usage on this node: 4.6/240.1 GiB
    Using AsyncHyperBand: num_stopped=8
    Bracket: Iter 8.000: -2.201333373451233 | Iter 4.000: -2.1173613599538803 | Iter 2.000: -1.8522035459518433 | Iter 1.000: -2.047291660219431
    Resources requested: 4/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT
    Number of trials: 10 (2 RUNNING, 8 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_79ae1_00000 | TERMINATED |                 |           16 |  256 |    8 | 0.000100905 | 2.3222  |     0.1017 |                    1 |
    | DEFAULT_79ae1_00001 | TERMINATED |                 |            4 |    4 |   64 | 0.00502624  | 2.30159 |     0.1038 |                    4 |
    | DEFAULT_79ae1_00002 | RUNNING    | 172.17.0.2:1101 |            8 |    8 |    8 | 0.000388007 | 1.47433 |     0.4388 |                    7 |
    | DEFAULT_79ae1_00003 | TERMINATED |                 |           16 |    4 |   32 | 0.0243759   | 2.30105 |     0.1039 |                   10 |
    | DEFAULT_79ae1_00004 | TERMINATED |                 |            2 |   32 |  128 | 0.00376088  | 1.85368 |     0.2907 |                    2 |
    | DEFAULT_79ae1_00005 | TERMINATED |                 |           16 |    8 |   32 | 0.0600091   | 2.30412 |     0.0997 |                    1 |
    | DEFAULT_79ae1_00006 | TERMINATED |                 |            2 |  128 |   64 | 0.0318437   | 2.33229 |     0.1007 |                    1 |
    | DEFAULT_79ae1_00007 | RUNNING    | 172.17.0.2:1082 |            8 |    8 |    8 | 0.00975354  | 2.10327 |     0.2025 |                    8 |
    | DEFAULT_79ae1_00008 | TERMINATED |                 |            2 |   64 |  128 | 0.00594678  | 2.01831 |     0.239  |                    1 |
    | DEFAULT_79ae1_00009 | TERMINATED |                 |            8 |    8 |    4 | 0.000398399 | 2.30283 |     0.097  |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_79ae1_00002:
      accuracy: 0.4609
      date: 2020-09-21_20-43-11
      done: false
      experiment_id: cfab037e3fcd473a92d773d729f383ed
      experiment_tag: 2_batch_size=8,l1=8,l2=8,lr=0.00038801
      hostname: 18e16d8a13a6
      iterations_since_restore: 8
      loss: 1.4512013450145722
      node_ip: 172.17.0.2
      pid: 1101
      should_checkpoint: true
      time_since_restore: 251.70548582077026
      time_this_iter_s: 27.880488395690918
      time_total_s: 251.70548582077026
      timestamp: 1600720991
      timesteps_since_restore: 0
      training_iteration: 8
      trial_id: 79ae1_00002
  
    [2m[36m(pid=1082)[0m [9,  2000] loss: 1.915
    [2m[36m(pid=1101)[0m [9,  2000] loss: 1.425
    [2m[36m(pid=1082)[0m [9,  4000] loss: 1.055
    [2m[36m(pid=1101)[0m [9,  4000] loss: 0.699
    Result for DEFAULT_79ae1_00007:
      accuracy: 0.1089
      date: 2020-09-21_20-43-37
      done: false
      experiment_id: b968c158f8f04acfa889e6269e06743b
      experiment_tag: 7_batch_size=8,l1=8,l2=8,lr=0.0097535
      hostname: 18e16d8a13a6
      iterations_since_restore: 9
      loss: 2.2825397274017334
      node_ip: 172.17.0.2
      pid: 1082
      should_checkpoint: true
      time_since_restore: 277.9951310157776
      time_this_iter_s: 28.124532461166382
      time_total_s: 277.9951310157776
      timestamp: 1600721017
      timesteps_since_restore: 0
      training_iteration: 9
      trial_id: 79ae1_00007
  
    == Status ==
    Memory usage on this node: 4.6/240.1 GiB
    Using AsyncHyperBand: num_stopped=8
    Bracket: Iter 8.000: -2.103267540740967 | Iter 4.000: -2.1173613599538803 | Iter 2.000: -1.8522035459518433 | Iter 1.000: -2.047291660219431
    Resources requested: 4/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT
    Number of trials: 10 (2 RUNNING, 8 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_79ae1_00000 | TERMINATED |                 |           16 |  256 |    8 | 0.000100905 | 2.3222  |     0.1017 |                    1 |
    | DEFAULT_79ae1_00001 | TERMINATED |                 |            4 |    4 |   64 | 0.00502624  | 2.30159 |     0.1038 |                    4 |
    | DEFAULT_79ae1_00002 | RUNNING    | 172.17.0.2:1101 |            8 |    8 |    8 | 0.000388007 | 1.4512  |     0.4609 |                    8 |
    | DEFAULT_79ae1_00003 | TERMINATED |                 |           16 |    4 |   32 | 0.0243759   | 2.30105 |     0.1039 |                   10 |
    | DEFAULT_79ae1_00004 | TERMINATED |                 |            2 |   32 |  128 | 0.00376088  | 1.85368 |     0.2907 |                    2 |
    | DEFAULT_79ae1_00005 | TERMINATED |                 |           16 |    8 |   32 | 0.0600091   | 2.30412 |     0.0997 |                    1 |
    | DEFAULT_79ae1_00006 | TERMINATED |                 |            2 |  128 |   64 | 0.0318437   | 2.33229 |     0.1007 |                    1 |
    | DEFAULT_79ae1_00007 | RUNNING    | 172.17.0.2:1082 |            8 |    8 |    8 | 0.00975354  | 2.28254 |     0.1089 |                    9 |
    | DEFAULT_79ae1_00008 | TERMINATED |                 |            2 |   64 |  128 | 0.00594678  | 2.01831 |     0.239  |                    1 |
    | DEFAULT_79ae1_00009 | TERMINATED |                 |            8 |    8 |    4 | 0.000398399 | 2.30283 |     0.097  |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_79ae1_00002:
      accuracy: 0.4827
      date: 2020-09-21_20-43-39
      done: false
      experiment_id: cfab037e3fcd473a92d773d729f383ed
      experiment_tag: 2_batch_size=8,l1=8,l2=8,lr=0.00038801
      hostname: 18e16d8a13a6
      iterations_since_restore: 9
      loss: 1.3903643867492677
      node_ip: 172.17.0.2
      pid: 1101
      should_checkpoint: true
      time_since_restore: 279.9267737865448
      time_this_iter_s: 28.221287965774536
      time_total_s: 279.9267737865448
      timestamp: 1600721019
      timesteps_since_restore: 0
      training_iteration: 9
      trial_id: 79ae1_00002
  
    [2m[36m(pid=1082)[0m [10,  2000] loss: 2.280
    [2m[36m(pid=1101)[0m [10,  2000] loss: 1.379
    [2m[36m(pid=1082)[0m [10,  4000] loss: 1.147
    [2m[36m(pid=1101)[0m [10,  4000] loss: 0.684
    Result for DEFAULT_79ae1_00007:
      accuracy: 0.1009
      date: 2020-09-21_20-44-05
      done: true
      experiment_id: b968c158f8f04acfa889e6269e06743b
      experiment_tag: 7_batch_size=8,l1=8,l2=8,lr=0.0097535
      hostname: 18e16d8a13a6
      iterations_since_restore: 10
      loss: 2.302148694419861
      node_ip: 172.17.0.2
      pid: 1082
      should_checkpoint: true
      time_since_restore: 305.90295219421387
      time_this_iter_s: 27.90782117843628
      time_total_s: 305.90295219421387
      timestamp: 1600721045
      timesteps_since_restore: 0
      training_iteration: 10
      trial_id: 79ae1_00007
  
    == Status ==
    Memory usage on this node: 4.6/240.1 GiB
    Using AsyncHyperBand: num_stopped=9
    Bracket: Iter 8.000: -2.103267540740967 | Iter 4.000: -2.1173613599538803 | Iter 2.000: -1.8522035459518433 | Iter 1.000: -2.047291660219431
    Resources requested: 4/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT
    Number of trials: 10 (2 RUNNING, 8 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_79ae1_00000 | TERMINATED |                 |           16 |  256 |    8 | 0.000100905 | 2.3222  |     0.1017 |                    1 |
    | DEFAULT_79ae1_00001 | TERMINATED |                 |            4 |    4 |   64 | 0.00502624  | 2.30159 |     0.1038 |                    4 |
    | DEFAULT_79ae1_00002 | RUNNING    | 172.17.0.2:1101 |            8 |    8 |    8 | 0.000388007 | 1.39036 |     0.4827 |                    9 |
    | DEFAULT_79ae1_00003 | TERMINATED |                 |           16 |    4 |   32 | 0.0243759   | 2.30105 |     0.1039 |                   10 |
    | DEFAULT_79ae1_00004 | TERMINATED |                 |            2 |   32 |  128 | 0.00376088  | 1.85368 |     0.2907 |                    2 |
    | DEFAULT_79ae1_00005 | TERMINATED |                 |           16 |    8 |   32 | 0.0600091   | 2.30412 |     0.0997 |                    1 |
    | DEFAULT_79ae1_00006 | TERMINATED |                 |            2 |  128 |   64 | 0.0318437   | 2.33229 |     0.1007 |                    1 |
    | DEFAULT_79ae1_00007 | RUNNING    | 172.17.0.2:1082 |            8 |    8 |    8 | 0.00975354  | 2.30215 |     0.1009 |                   10 |
    | DEFAULT_79ae1_00008 | TERMINATED |                 |            2 |   64 |  128 | 0.00594678  | 2.01831 |     0.239  |                    1 |
    | DEFAULT_79ae1_00009 | TERMINATED |                 |            8 |    8 |    4 | 0.000398399 | 2.30283 |     0.097  |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_79ae1_00002:
      accuracy: 0.502
      date: 2020-09-21_20-44-07
      done: true
      experiment_id: cfab037e3fcd473a92d773d729f383ed
      experiment_tag: 2_batch_size=8,l1=8,l2=8,lr=0.00038801
      hostname: 18e16d8a13a6
      iterations_since_restore: 10
      loss: 1.3655993687152863
      node_ip: 172.17.0.2
      pid: 1101
      should_checkpoint: true
      time_since_restore: 307.5741539001465
      time_this_iter_s: 27.647380113601685
      time_total_s: 307.5741539001465
      timestamp: 1600721047
      timesteps_since_restore: 0
      training_iteration: 10
      trial_id: 79ae1_00002
  
    == Status ==
    Memory usage on this node: 4.1/240.1 GiB
    Using AsyncHyperBand: num_stopped=10
    Bracket: Iter 8.000: -2.103267540740967 | Iter 4.000: -2.1173613599538803 | Iter 2.000: -1.8522035459518433 | Iter 1.000: -2.047291660219431
    Resources requested: 0/32 CPUs, 0/2 GPUs, 0.0/157.81 GiB heap, 0.0/49.41 GiB objects
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT
    Number of trials: 10 (10 TERMINATED)
    +---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc   |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_79ae1_00000 | TERMINATED |       |           16 |  256 |    8 | 0.000100905 | 2.3222  |     0.1017 |                    1 |
    | DEFAULT_79ae1_00001 | TERMINATED |       |            4 |    4 |   64 | 0.00502624  | 2.30159 |     0.1038 |                    4 |
    | DEFAULT_79ae1_00002 | TERMINATED |       |            8 |    8 |    8 | 0.000388007 | 1.3656  |     0.502  |                   10 |
    | DEFAULT_79ae1_00003 | TERMINATED |       |           16 |    4 |   32 | 0.0243759   | 2.30105 |     0.1039 |                   10 |
    | DEFAULT_79ae1_00004 | TERMINATED |       |            2 |   32 |  128 | 0.00376088  | 1.85368 |     0.2907 |                    2 |
    | DEFAULT_79ae1_00005 | TERMINATED |       |           16 |    8 |   32 | 0.0600091   | 2.30412 |     0.0997 |                    1 |
    | DEFAULT_79ae1_00006 | TERMINATED |       |            2 |  128 |   64 | 0.0318437   | 2.33229 |     0.1007 |                    1 |
    | DEFAULT_79ae1_00007 | TERMINATED |       |            8 |    8 |    8 | 0.00975354  | 2.30215 |     0.1009 |                   10 |
    | DEFAULT_79ae1_00008 | TERMINATED |       |            2 |   64 |  128 | 0.00594678  | 2.01831 |     0.239  |                    1 |
    | DEFAULT_79ae1_00009 | TERMINATED |       |            8 |    8 |    4 | 0.000398399 | 2.30283 |     0.097  |                    1 |
    +---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------+


    Best trial config: {'l1': 8, 'l2': 8, 'lr': 0.00038800718018527913, 'batch_size': 8}
    Best trial final validation loss: 1.3655993687152863
    Best trial final validation accuracy: 0.502
    Files already downloaded and verified
    Files already downloaded and verified
    Best trial test set accuracy: 0.5049


If you run the code, an example output could look like this:

.. code-block::

    Number of trials: 10 (10 TERMINATED)
    +-----+------+------+-------------+--------------+---------+------------+--------------------+
    | ... |   l1 |   l2 |          lr |   batch_size |    loss |   accuracy | training_iteration |
    |-----+------+------+-------------+--------------+---------+------------+--------------------|
    | ... |   64 |    4 | 0.00011629  |            2 | 1.87273 |     0.244  |                  2 |
    | ... |   32 |   64 | 0.000339763 |            8 | 1.23603 |     0.567  |                  8 |
    | ... |    8 |   16 | 0.00276249  |           16 | 1.1815  |     0.5836 |                 10 |
    | ... |    4 |   64 | 0.000648721 |            4 | 1.31131 |     0.5224 |                  8 |
    | ... |   32 |   16 | 0.000340753 |            8 | 1.26454 |     0.5444 |                  8 |
    | ... |    8 |    4 | 0.000699775 |            8 | 1.99594 |     0.1983 |                  2 |
    | ... |  256 |    8 | 0.0839654   |           16 | 2.3119  |     0.0993 |                  1 |
    | ... |   16 |  128 | 0.0758154   |           16 | 2.33575 |     0.1327 |                  1 |
    | ... |   16 |    8 | 0.0763312   |           16 | 2.31129 |     0.1042 |                  4 |
    | ... |  128 |   16 | 0.000124903 |            4 | 2.26917 |     0.1945 |                  1 |
    +-----+------+------+-------------+--------------+---------+------------+--------------------+


    Best trial config: {'l1': 8, 'l2': 16, 'lr': 0.00276249, 'batch_size': 16, 'data_dir': '...'}
    Best trial final validation loss: 1.181501
    Best trial final validation accuracy: 0.5836
    Best trial test set accuracy: 0.5806

Most trials have been stopped early in order to avoid wasting resources.
The best performing trial achieved a validation accuracy of about 58%, which could
be confirmed on the test set.

So that's it! You can now tune the parameters of your PyTorch models.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 5 minutes  27.108 seconds)


.. _sphx_glr_download_beginner_hyperparameter_tuning_tutorial.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download

     :download:`Download Python source code: hyperparameter_tuning_tutorial.py <hyperparameter_tuning_tutorial.py>`



  .. container:: sphx-glr-download

     :download:`Download Jupyter notebook: hyperparameter_tuning_tutorial.ipynb <hyperparameter_tuning_tutorial.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.readthedocs.io>`_
